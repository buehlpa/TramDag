<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 16.0.0"/>
    <title>tramdag.TramDagDataset API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:27px;vertical-align:bottom;width:50px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../tramdag.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;tramdag</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#TramDagDataset">TramDagDataset</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TramDagDataset.__init__">TramDagDataset</a>
                        </li>
                        <li>
                                <a class="variable" href="#TramDagDataset.DEFAULTS">DEFAULTS</a>
                        </li>
                        <li>
                                <a class="function" href="#TramDagDataset.from_dataframe">from_dataframe</a>
                        </li>
                        <li>
                                <a class="function" href="#TramDagDataset.compute_scaling">compute_scaling</a>
                        </li>
                        <li>
                                <a class="function" href="#TramDagDataset.summary">summary</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22160%22%20viewBox%3D%220%200%20150%2080%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M132.316%2048.886c.276-4.679%202.342-6.698%204.409-7.982s4.27-1.165%206.751-1.055c1.586.07%203.044.156%204.222-.482%201.142-.619%202.026-1.932%202.162-3.739.268-3.576-1.929-5.368-5.006-5.551s-7.599.524-10.517%201.606c-4.455%201.652-8.588%206.606-9.552%208.992s-2.342%206.193-1.745%2010.873%202.664%209.221%205.878%2011.79%205.878%203.808%2010.103%204.312%203.444.229%206.062.229%205.006-2.202%204.914-4.909-2.296-5.001-4.501-4.863-3.077.505-5.281.229-7.715-2.064-7.899-9.451z%22%20fill%3D%22%23198754%22/%3E%3Ccircle%20cx%3D%22101.504%22%20cy%3D%2248.943%22%20r%3D%2214.208%22%20fill%3D%22none%22%20stroke%3D%22%23198754%22%20stroke-width%3D%229.354%22/%3E%3Cpath%20d%3D%22M87.81.002c-3.637.065-5.001.454-7.014%201.232s-3.443%201.363-6.3%204.282c-1.723%201.76-3.148%205.019-3.776%207.329-.413%201.521-.316%202.63-.316%202.63l-.195%2034.612c.065%205.774-6.755%208.305-9.612%208.37s-9.678-1.038-9.743-9.408%207.128-9.521%208.362-9.521c1.413-.13%202.526-.021%203.718-.016%202.071.009%204.157-.778%204.092-4.671s-4.157-4.736-4.157-4.736c-6.3-.843-11.43%202.206-11.43%202.206S40.917%2038.15%2041.372%2049.634%2051.568%2068.19%2061.311%2068.125s18.316-7.007%2018.445-17.193l.13-22.772c.046-2.291%202.683-3.644%204.476-4.203.745-.232%201.694-.274%201.694-.274l10.457-.13s4.871-.324%207.729-3.114%204.352-6.294%204.352-6.294.974-3.049.13-4.606-.195-1.233-2.792-3.309-8.573-4.477-8.573-4.477S91.447-.063%2087.81.002zM0%2047.169l.065%2028.417S0%2080.127%204.481%2079.997s5.072-3.866%205.049-4.152l-.113-28.482s1.624-7.656%209.937-7.721%2010.002%206.942%2010.002%208.499-.909%2010.51-9.093%2010.51c-.948%200-2.99-.567-4.145-.272-3.919%201-3.194%204.554-3.194%204.554s.065%205.061%207.404%204.996%2018.575-6.034%2018.575-19.074S26.953%2030.04%2019.549%2029.91%201.234%2035.296%200%2047.169z%22%20fill%3D%22%23198754%22/%3E%3Cg%20transform%3D%22matrix%28.325601%200%200%20.325256%20-10.32669%20-45.802786%29%22%3E%3Ccircle%20cx%3D%22297.554%22%20cy%3D%22172.286%22%20r%3D%2216.5%22%20fill%3D%22%23fff%22/%3E%3Cellipse%20cx%3D%22297.709%22%20cy%3D%22172.642%22%20rx%3D%2211.071%22%20ry%3D%2210.871%22%20fill%3D%22%23105a48%22/%3E%3Ccircle%20cx%3D%22304.104%22%20cy%3D%22167.667%22%20r%3D%224.5%22%20fill%3D%22%23fff%22/%3E%3C/g%3E%3Cpath%20d%3D%22M94.661%2017.032l.893-1.476s.99.714%201.916.925%201.575.114%202.955.114l14.565-.162c1.283-.032%203.085-.762%203.02-3.293s-.373-3.503-.373-3.503l1.283-.487s.52.503.877%201.573.309%201.995.292%202.66-.227%201.541-.227%201.541%201.564-.308%202.359-1.038.823-.779%201.489-1.508.812-.86.812-.86.552-.13.877.26.341.957.065%201.46-1.672%202.206-3.247%203.066-2.76%201.427-3.929%201.768-3.848.73-7.063.714l-10.944-.114s-2.143-.081-3.02-.373-2.241-.973-2.598-1.265z%22%20fill%3D%22%23d36d49%22/%3E%3Cg%20fill%3D%22%23105a48%22%3E%3Cellipse%20cx%3D%2293.052%22%20cy%3D%2243.567%22%20rx%3D%22.869%22%20ry%3D%221.014%22%20transform%3D%22rotate%28341.022%29%22/%3E%3Cellipse%20cx%3D%22104.3%22%20cy%3D%22-16.184%22%20rx%3D%22.865%22%20ry%3D%221.009%22%20transform%3D%22rotate%2814.786%29%22/%3E%3C/g%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../tramdag.html">tramdag</a><wbr>.TramDagDataset    </h1>

                        <div class="docstring"><p>Copyright 2025 Zurich University of Applied Sciences (ZHAW)
Pascal Buehler, Beate Sick, Oliver Duerr</p>

<p>Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p>

<pre><code>http://www.apache.org/licenses/LICENSE-2.0
</code></pre>

<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p>
</div>

                        <input id="mod-TramDagDataset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-TramDagDataset-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">Copyright 2025 Zurich University of Applied Sciences (ZHAW)</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">Pascal Buehler, Beate Sick, Oliver Duerr</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">you may not use this file except in compliance with the License.</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">You may obtain a copy of the License at</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">    http://www.apache.org/licenses/LICENSE-2.0</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="sd">Unless required by applicable law or agreed to in writing, software</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="sd">distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="sd">WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="sd">See the License for the specific language governing permissions and</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="sd">limitations under the License.</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">inspect</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torch.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">DataLoader</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">GenericDataset</span><span class="p">,</span> <span class="n">GenericDatasetPrecomputed</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="k">class</span><span class="w"> </span><span class="nc">TramDagDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="w">    </span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">    TramDagDataset</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">    ==============</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">    The `TramDagDataset` class handles structured data preparation for TRAM-DAG</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">    models. It wraps a pandas DataFrame together with its configuration and provides</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">    utilities for scaling, transformation, and efficient DataLoader construction</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">    for each node in a DAG-based configuration.</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">    ---------------------------------------------------------------------</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">    Core Responsibilities</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">    ---------------------------------------------------------------------</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">    - Validate and store configuration metadata (`TramDagConfig`).</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">    - Manage per-node settings for DataLoader creation (batch size, shuffling, workers).</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">    - Compute scaling information (quantile-based min/max).</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">    - Optionally precompute and cache dataset representations.</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">    - Expose PyTorch Dataset and DataLoader interfaces for model training.</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">    ---------------------------------------------------------------------</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">    Key Attributes</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">    ---------------------------------------------------------------------</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">    - **df** : pandas.DataFrame  </span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">      The dataset content used for building loaders and computing scaling.</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">    - **cfg** : TramDagConfig  </span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">      Configuration object defining nodes and variable metadata.</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">    - **nodes_dict** : dict  </span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">      Mapping of variable names to node specifications from the configuration.</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">    - **loaders** : dict  </span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">      Mapping of node names to `torch.utils.data.DataLoader` instances or `GenericDataset` objects.</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">    - **DEFAULTS** : dict  </span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">      Default DataLoader and dataset-related settings (e.g., batch_size, shuffle, num_workers, etc.).</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">    ---------------------------------------------------------------------</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">    Main Methods</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">    ---------------------------------------------------------------------</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">    - **from_dataframe(df, cfg, **kwargs)**  </span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">      Construct the dataset directly from a pandas DataFrame.</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">    - **compute_scaling(df=None, write=True)**  </span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">      Compute per-variable min/max scaling values from data.</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">    - **summary()**  </span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">      Print dataset overview including shape, dtypes, statistics, and node settings.</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">    ---------------------------------------------------------------------</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">    Notes</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">    ---------------------------------------------------------------------</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">    - Intended for training data; `compute_scaling()` should use only training subsets.</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">    - Compatible with both CPU and GPU DataLoader options.</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">    - Strict validation of keyword arguments against `DEFAULTS` prevents silent misconfiguration.</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">    ---------------------------------------------------------------------</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">    Example</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">    ---------------------------------------------------------------------</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">    &gt;&gt;&gt; cfg = TramDagConfig.from_json(&quot;config.json&quot;)</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">    &gt;&gt;&gt; dataset = TramDagDataset.from_dataframe(train_df, cfg, batch_size=1024, debug=True)</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">    &gt;&gt;&gt; dataset.summary()</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">    &gt;&gt;&gt; minmax = dataset.compute_scaling(train_df)</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">    &gt;&gt;&gt; loader = dataset.loaders[&quot;variable_x&quot;]</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">    &gt;&gt;&gt; next(iter(loader))</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>    <span class="n">DEFAULTS</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>        <span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="mi">32_000</span><span class="p">,</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>        <span class="s2">&quot;shuffle&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>        <span class="s2">&quot;num_workers&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>        <span class="s2">&quot;pin_memory&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>        <span class="s2">&quot;return_intercept_shift&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>        <span class="s2">&quot;debug&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>        <span class="s2">&quot;transform&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>        <span class="s2">&quot;use_dataloader&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>        <span class="s2">&quot;use_precomputed&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> 
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>        <span class="c1"># DataLoader extras</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>        <span class="s2">&quot;sampler&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>        <span class="s2">&quot;batch_sampler&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>        <span class="s2">&quot;collate_fn&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>        <span class="s2">&quot;drop_last&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>        <span class="s2">&quot;timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>        <span class="s2">&quot;worker_init_fn&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>        <span class="s2">&quot;multiprocessing_context&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>        <span class="s2">&quot;generator&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>        <span class="s2">&quot;prefetch_factor&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>        <span class="s2">&quot;persistent_workers&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>        <span class="s2">&quot;pin_memory_device&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>    <span class="p">}</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="sd">        Initialize an empty TramDagDataset shell.</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="sd">        Notes</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a><span class="sd">        -----</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a><span class="sd">        This constructor does not attach data or configuration. Use</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a><span class="sd">        `TramDagDataset.from_dataframe` to obtain a ready-to-use instance.</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>        <span class="k">pass</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_dataframe</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a><span class="sd">        Create a TramDagDataset instance directly from a pandas DataFrame.</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a><span class="sd">        This classmethod:</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="sd">        1. Validates keyword arguments against `DEFAULTS`.</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="sd">        2. Merges user overrides with defaults into a resolved settings dict.</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="sd">        3. Stores the configuration and verifies its completeness.</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="sd">        4. Applies settings to the instance.</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="sd">        5. Builds per-node datasets and DataLoaders.</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a><span class="sd">        Parameters</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="sd">        ----------</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a><span class="sd">        df : pandas.DataFrame</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="sd">            Input DataFrame containing the dataset.</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a><span class="sd">        cfg : TramDagConfig</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a><span class="sd">            Configuration object defining nodes and variable metadata.</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a><span class="sd">        **kwargs</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a><span class="sd">            Optional overrides for `DEFAULTS`. All keys must exist in</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a><span class="sd">            `TramDagDataset.DEFAULTS`. Common keys include:</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a><span class="sd">            batch_size : int</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a><span class="sd">                Batch size for DataLoaders.</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="sd">            shuffle : bool</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a><span class="sd">                Whether to shuffle samples per epoch.</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a><span class="sd">            num_workers : int</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="sd">                Number of DataLoader workers.</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">            pin_memory : bool</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="sd">                Whether to pin memory for faster host-to-device transfers.</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="sd">            return_intercept_shift : bool</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="sd">                Whether datasets should return intercept/shift information.</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="sd">            debug : bool</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a><span class="sd">                Enable debug printing.</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="sd">            transform : callable or dict or None</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a><span class="sd">                Optional transform(s) applied to samples.</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a><span class="sd">            use_dataloader : bool</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a><span class="sd">                If True, construct DataLoaders; else store raw Dataset objects.</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a><span class="sd">            use_precomputed : bool</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a><span class="sd">                If True, precompute dataset representation to disk and reload it.</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a><span class="sd">        Returns</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a><span class="sd">        -------</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a><span class="sd">        TramDagDataset</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a><span class="sd">            Initialized dataset instance.</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a><span class="sd">        Raises</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a><span class="sd">        ------</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a><span class="sd">        TypeError</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a><span class="sd">            If `df` is not a pandas DataFrame.</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a><span class="sd">        ValueError</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a><span class="sd">            If unknown keyword arguments are provided (when validation is enabled).</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a><span class="sd">        Notes</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a><span class="sd">        -----</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a><span class="sd">        If `shuffle=True` and the inferred variable name of `df` suggests</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a><span class="sd">        validation/test data (e.g. &quot;val&quot;, &quot;test&quot;), a warning is printed.</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>        <span class="bp">self</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[ERROR] df must be a pandas DataFrame, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>        <span class="c1"># validate kwargs</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>        <span class="c1"># TODO adjust validation such thath it works when called from tramdagmodel</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>        <span class="c1">#self._validate_kwargs(kwargs, context=&quot;from_dataframe&quot;)</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>        
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>        <span class="c1"># merge defaults with overrides</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>        <span class="n">settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">DEFAULTS</span><span class="p">)</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>        <span class="n">settings</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>        <span class="c1"># store config and verify</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span> <span class="o">=</span> <span class="n">cfg</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">_verify_completeness</span><span class="p">()</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>        <span class="c1"># ouptu all setttings if debug</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[DEBUG] TramDagDataset.from_dataframe() settings (after defaults + overrides):&quot;</span><span class="p">)</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>        <span class="c1"># infer variable name automatically</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>        <span class="n">callers_locals</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_back</span><span class="o">.</span><span class="n">f_locals</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>        <span class="n">inferred</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>        <span class="k">for</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">var_val</span> <span class="ow">in</span> <span class="n">callers_locals</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>            <span class="k">if</span> <span class="n">var_val</span> <span class="ow">is</span> <span class="n">df</span><span class="p">:</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>                <span class="n">inferred</span> <span class="o">=</span> <span class="n">var_name</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>                <span class="k">break</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>        <span class="n">df_name</span> <span class="o">=</span> <span class="n">inferred</span> <span class="ow">or</span> <span class="s2">&quot;dataframe&quot;</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>        <span class="k">if</span> <span class="n">settings</span><span class="p">[</span><span class="s2">&quot;shuffle&quot;</span><span class="p">]:</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">df_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;val&quot;</span><span class="p">,</span> <span class="s2">&quot;validation&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">]):</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[WARNING] DataFrame &#39;</span><span class="si">{</span><span class="n">df_name</span><span class="si">}</span><span class="s2">&#39; looks like a validation/test set  shuffle=True. Are you sure?&quot;</span><span class="p">)</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>        <span class="c1"># call again to ensure Warning messages if ordinal vars have missing levels</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_settings</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_build_dataloaders</span><span class="p">()</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">compute_scaling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">write</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a><span class="sd">        Compute variable-wise scaling parameters from data.</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a><span class="sd">        Per variable, this method computes approximate minimum and maximum</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a><span class="sd">        values using the 5th and 95th percentiles. This is typically used</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a><span class="sd">        to derive robust normalization/clipping ranges from training data.</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a><span class="sd">        Parameters</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="sd">        ----------</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="sd">        df : pandas.DataFrame or None, optional</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">            DataFrame used to compute scaling. If None, `self.df` is used.</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a><span class="sd">        write : bool, optional</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a><span class="sd">            Unused placeholder for interface compatibility with other components.</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="sd">            Kept for potential future extensions. Default is True.</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="sd">        Returns</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a><span class="sd">        -------</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a><span class="sd">        dict</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a><span class="sd">            Mapping `{column_name: [min_value, max_value]}`, where values</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a><span class="sd">            are derived from the 0.05 and 0.95 quantiles.</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a><span class="sd">        Notes</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a><span class="sd">        -----</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a><span class="sd">        If `self.debug` is True, the method emits debug messages about the</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a><span class="sd">        data source. Only training data should be used to avoid leakage.</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[DEBUG] Make sure to provide only training data to compute_scaling!&quot;</span><span class="p">)</span>     
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>        <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[DEBUG] No DataFrame provided, using internal df.&quot;</span><span class="p">)</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>        <span class="n">quantiles</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>        <span class="n">min_vals</span> <span class="o">=</span> <span class="n">quantiles</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">0.05</span><span class="p">]</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>        <span class="n">max_vals</span> <span class="o">=</span> <span class="n">quantiles</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">0.95</span><span class="p">]</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>        <span class="n">minmax_dict</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">min_vals</span><span class="p">,</span> <span class="n">max_vals</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>        <span class="k">return</span> <span class="n">minmax_dict</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a><span class="sd">        Print a structured overview of the dataset and configuration.</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a><span class="sd">        The summary includes:</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a><span class="sd">        1. DataFrame information:</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a><span class="sd">        - Shape</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a><span class="sd">        - Columns</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a><span class="sd">        - Head (first rows)</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a><span class="sd">        - Dtypes</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a><span class="sd">        - Descriptive statistics</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a><span class="sd">        2. Configuration overview:</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a><span class="sd">        - Number of nodes</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a><span class="sd">        - Loader mode (DataLoader vs. raw Dataset)</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a><span class="sd">        - Precomputation status</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a><span class="sd">        3. Node settings:</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a><span class="sd">        - Batch size</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a><span class="sd">        - Shuffle flag</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a><span class="sd">        - num_workers</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="sd">        - pin_memory</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a><span class="sd">        - return_intercept_shift</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a><span class="sd">        - debug</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="sd">        - transform</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="sd">        4. DataLoader overview:</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a><span class="sd">        - Type and length of each loader.</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a><span class="sd">        Parameters</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a><span class="sd">        ----------</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a><span class="sd">        None</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a><span class="sd">        Returns</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a><span class="sd">        -------</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a><span class="sd">        None</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a><span class="sd">        Notes</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a><span class="sd">        -----</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a><span class="sd">        Intended for quick inspection and debugging. Uses `print` statements</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a><span class="sd">        and does not return structured metadata.</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>        
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[TramDagDataset Summary]&quot;</span><span class="p">)</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[DataFrame]&quot;</span><span class="p">)</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Columns:&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Head:&quot;</span><span class="p">)</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Dtypes:&quot;</span><span class="p">)</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Describe:&quot;</span><span class="p">)</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">))</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[Configuration]&quot;</span><span class="p">)</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nodes: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loader mode: </span><span class="si">{</span><span class="s1">&#39;DataLoader&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">use_dataloader</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Direct dataset&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precomputed: </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;use_precomputed&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">False</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[Node Settings]&quot;</span><span class="p">)</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>            <span class="n">batch_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>            <span class="n">shuffle_flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>            <span class="n">num_workers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>            <span class="n">pin_memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin_memory</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pin_memory</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin_memory</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>            <span class="n">rshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_intercept_shift</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">return_intercept_shift</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_intercept_shift</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>            <span class="n">debug_flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>            <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>            <span class="nb">print</span><span class="p">(</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>                <span class="sa">f</span><span class="s2">&quot; Node &#39;</span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">&#39;: &quot;</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>                <span class="sa">f</span><span class="s2">&quot;batch_size=</span><span class="si">{</span><span class="n">batch_size</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>                <span class="sa">f</span><span class="s2">&quot;shuffle=</span><span class="si">{</span><span class="n">shuffle_flag</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>                <span class="sa">f</span><span class="s2">&quot;num_workers=</span><span class="si">{</span><span class="n">num_workers</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>                <span class="sa">f</span><span class="s2">&quot;pin_memory=</span><span class="si">{</span><span class="n">pin_memory</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>                <span class="sa">f</span><span class="s2">&quot;return_intercept_shift=</span><span class="si">{</span><span class="n">rshift</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>                <span class="sa">f</span><span class="s2">&quot;debug=</span><span class="si">{</span><span class="n">debug_flag</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>                <span class="sa">f</span><span class="s2">&quot;transform=</span><span class="si">{</span><span class="n">transform</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>            <span class="p">)</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;loaders&quot;</span><span class="p">):</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[DataLoaders]&quot;</span><span class="p">)</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>            <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">loader</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaders</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>                    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">loader</span><span class="p">)</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>                    <span class="n">length</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">loader</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">, len=</span><span class="si">{</span><span class="n">length</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">defaults_attr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;DEFAULTS&quot;</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a><span class="sd">        Validate keyword arguments against a defaults dictionary.</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a><span class="sd">        Parameters</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a><span class="sd">        ----------</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a><span class="sd">        kwargs : dict</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a><span class="sd">            Keyword arguments to validate.</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a><span class="sd">        defaults_attr : str, optional</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a><span class="sd">            Name of the attribute on this class containing the default keys</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a><span class="sd">            (e.g. &quot;DEFAULTS&quot;). Default is &quot;DEFAULTS&quot;.</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a><span class="sd">        context : str or None, optional</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a><span class="sd">            Optional context label (e.g. caller name) included in error messages.</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a><span class="sd">        Raises</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a><span class="sd">        ------</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a><span class="sd">        AttributeError</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a><span class="sd">            If the attribute named by `defaults_attr` does not exist.</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a><span class="sd">        ValueError</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a><span class="sd">            If any keys in `kwargs` are not present in the defaults dictionary.</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>        <span class="n">defaults</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">defaults_attr</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>        <span class="k">if</span> <span class="n">defaults</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> has no attribute &#39;</span><span class="si">{</span><span class="n">defaults_attr</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>        <span class="n">unknown</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">defaults</span><span class="p">)</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>        <span class="k">if</span> <span class="n">unknown</span><span class="p">:</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>            <span class="n">prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">] &quot;</span> <span class="k">if</span> <span class="n">context</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">Unknown parameter(s): </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">unknown</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">settings</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a><span class="sd">        Apply resolved settings to the dataset instance.</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a><span class="sd">        This method:</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a><span class="sd">        1. Stores all keyvalue pairs from `settings` as attributes on `self`.</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a><span class="sd">        2. Extracts `nodes_dict` from the configuration.</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a><span class="sd">        3. Validates that dict-valued core attributes (batch_size, shuffle, etc.)</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a><span class="sd">        have keys matching the node set.</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a><span class="sd">        Parameters</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a><span class="sd">        ----------</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a><span class="sd">        settings : dict</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a><span class="sd">            Resolved settings dictionary, usually built from `DEFAULTS` plus</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a><span class="sd">            user overrides.</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a><span class="sd">        Returns</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a><span class="sd">        -------</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a><span class="sd">        None</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a><span class="sd">        Raises</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a><span class="sd">        ------</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a><span class="sd">        ValueError</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a><span class="sd">            If any dict-valued core attribute has keys that do not match</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a><span class="sd">            `cfg.conf_dict[&quot;nodes&quot;].keys()`.</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">conf_dict</span><span class="p">[</span><span class="s2">&quot;nodes&quot;</span><span class="p">]</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>        <span class="c1"># validate only the most important ones</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;batch_size&quot;</span><span class="p">,</span> <span class="s2">&quot;shuffle&quot;</span><span class="p">,</span> <span class="s2">&quot;num_workers&quot;</span><span class="p">,</span> <span class="s2">&quot;pin_memory&quot;</span><span class="p">,</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>                     <span class="s2">&quot;return_intercept_shift&quot;</span><span class="p">,</span> <span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="s2">&quot;transform&quot;</span><span class="p">]:</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_check_keys</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_build_dataloaders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build node-specific dataloaders or raw datasets depending on settings.&quot;&quot;&quot;</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">loaders</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">:</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>            <span class="n">ds</span> <span class="o">=</span> <span class="n">GenericDataset</span><span class="p">(</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>                <span class="n">target_col</span><span class="o">=</span><span class="n">node</span><span class="p">,</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>                <span class="n">target_nodes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">,</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>                <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">[</span><span class="n">node</span><span class="p">],</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>                <span class="n">return_intercept_shift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">return_intercept_shift</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">return_intercept_shift</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_intercept_shift</span><span class="p">[</span><span class="n">node</span><span class="p">],</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>                <span class="n">debug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">[</span><span class="n">node</span><span class="p">],</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>            <span class="p">)</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>        <span class="c1">########## QUICK PATCH </span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;use_precomputed&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_precomputed</span><span class="p">:</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;temp&quot;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>                <span class="n">pth</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;temp&quot;</span><span class="p">,</span> <span class="s2">&quot;precomputed.pt&quot;</span><span class="p">)</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s2">&quot;save_precomputed&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s2">&quot;save_precomputed&quot;</span><span class="p">)):</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>                    <span class="n">ds</span><span class="o">.</span><span class="n">save_precomputed</span><span class="p">(</span><span class="n">pth</span><span class="p">)</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>                    <span class="n">ds</span> <span class="o">=</span> <span class="n">GenericDatasetPrecomputed</span><span class="p">(</span><span class="n">pth</span><span class="p">)</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[WARNING] Dataset has no &#39;save_precomputed()&#39; method  skipping precomputation.&quot;</span><span class="p">)</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_dataloader</span><span class="p">:</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>                <span class="c1"># resolve per-node overrides</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>                <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>                    <span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>                    <span class="s2">&quot;shuffle&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span><span class="p">,</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>                    <span class="s2">&quot;num_workers&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">,</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>                    <span class="s2">&quot;pin_memory&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin_memory</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pin_memory</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin_memory</span><span class="p">,</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>                    <span class="s2">&quot;sampler&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampler</span><span class="p">,</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>                    <span class="s2">&quot;batch_sampler&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_sampler</span><span class="p">,</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>                    <span class="s2">&quot;collate_fn&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">collate_fn</span><span class="p">,</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>                    <span class="s2">&quot;drop_last&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">drop_last</span><span class="p">,</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>                    <span class="s2">&quot;timeout&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>                    <span class="s2">&quot;worker_init_fn&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">worker_init_fn</span><span class="p">,</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>                    <span class="s2">&quot;multiprocessing_context&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiprocessing_context</span><span class="p">,</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>                    <span class="s2">&quot;generator&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="p">,</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>                    <span class="s2">&quot;prefetch_factor&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefetch_factor</span><span class="p">,</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>                    <span class="s2">&quot;persistent_workers&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">persistent_workers</span><span class="p">,</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>                    <span class="s2">&quot;pin_memory_device&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin_memory_device</span><span class="p">,</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>                <span class="p">}</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">loaders</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">loaders</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>                
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;use_precomputed&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_precomputed</span><span class="p">:</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">pth</span><span class="p">):</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>                    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">pth</span><span class="p">)</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] Removed existing precomputed file: </span><span class="si">{</span><span class="n">pth</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[WARNING] Could not remove </span><span class="si">{</span><span class="n">pth</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_check_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_value</span><span class="p">):</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a><span class="sd">        Check that dict-valued attributes use node names as keys.</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a><span class="sd">        Parameters</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a><span class="sd">        ----------</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a><span class="sd">        attr_name : str</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a><span class="sd">            Name of the attribute being checked (for error messages).</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a><span class="sd">        attr_value : Any</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a><span class="sd">            Attribute value. If it is a dict, its keys are validated.</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a><span class="sd">        Returns</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a><span class="sd">        -------</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a><span class="sd">        None</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a><span class="sd">        Raises</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a><span class="sd">        ------</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a><span class="sd">        ValueError</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a><span class="sd">            If `attr_value` is a dict and its keys do not exactly match</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a><span class="sd">            `cfg.conf_dict[&quot;nodes&quot;].keys()`.</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a><span class="sd">        Notes</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a><span class="sd">        -----</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a><span class="sd">        This check prevents partial or mismatched per-node settings such as</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a><span class="sd">        batch sizes or shuffle flags.</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attr_value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>            <span class="n">expected_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>            <span class="n">given_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">attr_value</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>            <span class="k">if</span> <span class="n">expected_keys</span> <span class="o">!=</span> <span class="n">given_keys</span><span class="p">:</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>                    <span class="sa">f</span><span class="s2">&quot;[ERROR] the provided attribute &#39;</span><span class="si">{</span><span class="n">attr_name</span><span class="si">}</span><span class="s2">&#39; keys are not same as in cfg.conf_dict[&#39;nodes&#39;].keys().</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>                    <span class="sa">f</span><span class="s2">&quot;Expected: </span><span class="si">{</span><span class="n">expected_keys</span><span class="si">}</span><span class="s2">, but got: </span><span class="si">{</span><span class="n">given_keys</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>                    <span class="sa">f</span><span class="s2">&quot;Please provide values for all variables.&quot;</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>                <span class="p">)</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="TramDagDataset">
                            <input id="TramDagDataset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TramDagDataset</span><wbr>(<span class="base">typing.Generic[+_T_co]</span>):

                <label class="view-source-button" for="TramDagDataset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TramDagDataset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TramDagDataset-29"><a href="#TramDagDataset-29"><span class="linenos"> 29</span></a><span class="k">class</span><span class="w"> </span><span class="nc">TramDagDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
</span><span id="TramDagDataset-30"><a href="#TramDagDataset-30"><span class="linenos"> 30</span></a><span class="w">    </span>
</span><span id="TramDagDataset-31"><a href="#TramDagDataset-31"><span class="linenos"> 31</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TramDagDataset-32"><a href="#TramDagDataset-32"><span class="linenos"> 32</span></a><span class="sd">    TramDagDataset</span>
</span><span id="TramDagDataset-33"><a href="#TramDagDataset-33"><span class="linenos"> 33</span></a><span class="sd">    ==============</span>
</span><span id="TramDagDataset-34"><a href="#TramDagDataset-34"><span class="linenos"> 34</span></a>
</span><span id="TramDagDataset-35"><a href="#TramDagDataset-35"><span class="linenos"> 35</span></a><span class="sd">    The `TramDagDataset` class handles structured data preparation for TRAM-DAG</span>
</span><span id="TramDagDataset-36"><a href="#TramDagDataset-36"><span class="linenos"> 36</span></a><span class="sd">    models. It wraps a pandas DataFrame together with its configuration and provides</span>
</span><span id="TramDagDataset-37"><a href="#TramDagDataset-37"><span class="linenos"> 37</span></a><span class="sd">    utilities for scaling, transformation, and efficient DataLoader construction</span>
</span><span id="TramDagDataset-38"><a href="#TramDagDataset-38"><span class="linenos"> 38</span></a><span class="sd">    for each node in a DAG-based configuration.</span>
</span><span id="TramDagDataset-39"><a href="#TramDagDataset-39"><span class="linenos"> 39</span></a>
</span><span id="TramDagDataset-40"><a href="#TramDagDataset-40"><span class="linenos"> 40</span></a><span class="sd">    ---------------------------------------------------------------------</span>
</span><span id="TramDagDataset-41"><a href="#TramDagDataset-41"><span class="linenos"> 41</span></a><span class="sd">    Core Responsibilities</span>
</span><span id="TramDagDataset-42"><a href="#TramDagDataset-42"><span class="linenos"> 42</span></a><span class="sd">    ---------------------------------------------------------------------</span>
</span><span id="TramDagDataset-43"><a href="#TramDagDataset-43"><span class="linenos"> 43</span></a><span class="sd">    - Validate and store configuration metadata (`TramDagConfig`).</span>
</span><span id="TramDagDataset-44"><a href="#TramDagDataset-44"><span class="linenos"> 44</span></a><span class="sd">    - Manage per-node settings for DataLoader creation (batch size, shuffling, workers).</span>
</span><span id="TramDagDataset-45"><a href="#TramDagDataset-45"><span class="linenos"> 45</span></a><span class="sd">    - Compute scaling information (quantile-based min/max).</span>
</span><span id="TramDagDataset-46"><a href="#TramDagDataset-46"><span class="linenos"> 46</span></a><span class="sd">    - Optionally precompute and cache dataset representations.</span>
</span><span id="TramDagDataset-47"><a href="#TramDagDataset-47"><span class="linenos"> 47</span></a><span class="sd">    - Expose PyTorch Dataset and DataLoader interfaces for model training.</span>
</span><span id="TramDagDataset-48"><a href="#TramDagDataset-48"><span class="linenos"> 48</span></a>
</span><span id="TramDagDataset-49"><a href="#TramDagDataset-49"><span class="linenos"> 49</span></a><span class="sd">    ---------------------------------------------------------------------</span>
</span><span id="TramDagDataset-50"><a href="#TramDagDataset-50"><span class="linenos"> 50</span></a><span class="sd">    Key Attributes</span>
</span><span id="TramDagDataset-51"><a href="#TramDagDataset-51"><span class="linenos"> 51</span></a><span class="sd">    ---------------------------------------------------------------------</span>
</span><span id="TramDagDataset-52"><a href="#TramDagDataset-52"><span class="linenos"> 52</span></a><span class="sd">    - **df** : pandas.DataFrame  </span>
</span><span id="TramDagDataset-53"><a href="#TramDagDataset-53"><span class="linenos"> 53</span></a><span class="sd">      The dataset content used for building loaders and computing scaling.</span>
</span><span id="TramDagDataset-54"><a href="#TramDagDataset-54"><span class="linenos"> 54</span></a>
</span><span id="TramDagDataset-55"><a href="#TramDagDataset-55"><span class="linenos"> 55</span></a><span class="sd">    - **cfg** : TramDagConfig  </span>
</span><span id="TramDagDataset-56"><a href="#TramDagDataset-56"><span class="linenos"> 56</span></a><span class="sd">      Configuration object defining nodes and variable metadata.</span>
</span><span id="TramDagDataset-57"><a href="#TramDagDataset-57"><span class="linenos"> 57</span></a>
</span><span id="TramDagDataset-58"><a href="#TramDagDataset-58"><span class="linenos"> 58</span></a><span class="sd">    - **nodes_dict** : dict  </span>
</span><span id="TramDagDataset-59"><a href="#TramDagDataset-59"><span class="linenos"> 59</span></a><span class="sd">      Mapping of variable names to node specifications from the configuration.</span>
</span><span id="TramDagDataset-60"><a href="#TramDagDataset-60"><span class="linenos"> 60</span></a>
</span><span id="TramDagDataset-61"><a href="#TramDagDataset-61"><span class="linenos"> 61</span></a><span class="sd">    - **loaders** : dict  </span>
</span><span id="TramDagDataset-62"><a href="#TramDagDataset-62"><span class="linenos"> 62</span></a><span class="sd">      Mapping of node names to `torch.utils.data.DataLoader` instances or `GenericDataset` objects.</span>
</span><span id="TramDagDataset-63"><a href="#TramDagDataset-63"><span class="linenos"> 63</span></a>
</span><span id="TramDagDataset-64"><a href="#TramDagDataset-64"><span class="linenos"> 64</span></a><span class="sd">    - **DEFAULTS** : dict  </span>
</span><span id="TramDagDataset-65"><a href="#TramDagDataset-65"><span class="linenos"> 65</span></a><span class="sd">      Default DataLoader and dataset-related settings (e.g., batch_size, shuffle, num_workers, etc.).</span>
</span><span id="TramDagDataset-66"><a href="#TramDagDataset-66"><span class="linenos"> 66</span></a>
</span><span id="TramDagDataset-67"><a href="#TramDagDataset-67"><span class="linenos"> 67</span></a><span class="sd">    ---------------------------------------------------------------------</span>
</span><span id="TramDagDataset-68"><a href="#TramDagDataset-68"><span class="linenos"> 68</span></a><span class="sd">    Main Methods</span>
</span><span id="TramDagDataset-69"><a href="#TramDagDataset-69"><span class="linenos"> 69</span></a><span class="sd">    ---------------------------------------------------------------------</span>
</span><span id="TramDagDataset-70"><a href="#TramDagDataset-70"><span class="linenos"> 70</span></a><span class="sd">    - **from_dataframe(df, cfg, **kwargs)**  </span>
</span><span id="TramDagDataset-71"><a href="#TramDagDataset-71"><span class="linenos"> 71</span></a><span class="sd">      Construct the dataset directly from a pandas DataFrame.</span>
</span><span id="TramDagDataset-72"><a href="#TramDagDataset-72"><span class="linenos"> 72</span></a>
</span><span id="TramDagDataset-73"><a href="#TramDagDataset-73"><span class="linenos"> 73</span></a><span class="sd">    - **compute_scaling(df=None, write=True)**  </span>
</span><span id="TramDagDataset-74"><a href="#TramDagDataset-74"><span class="linenos"> 74</span></a><span class="sd">      Compute per-variable min/max scaling values from data.</span>
</span><span id="TramDagDataset-75"><a href="#TramDagDataset-75"><span class="linenos"> 75</span></a>
</span><span id="TramDagDataset-76"><a href="#TramDagDataset-76"><span class="linenos"> 76</span></a><span class="sd">    - **summary()**  </span>
</span><span id="TramDagDataset-77"><a href="#TramDagDataset-77"><span class="linenos"> 77</span></a><span class="sd">      Print dataset overview including shape, dtypes, statistics, and node settings.</span>
</span><span id="TramDagDataset-78"><a href="#TramDagDataset-78"><span class="linenos"> 78</span></a>
</span><span id="TramDagDataset-79"><a href="#TramDagDataset-79"><span class="linenos"> 79</span></a><span class="sd">    ---------------------------------------------------------------------</span>
</span><span id="TramDagDataset-80"><a href="#TramDagDataset-80"><span class="linenos"> 80</span></a><span class="sd">    Notes</span>
</span><span id="TramDagDataset-81"><a href="#TramDagDataset-81"><span class="linenos"> 81</span></a><span class="sd">    ---------------------------------------------------------------------</span>
</span><span id="TramDagDataset-82"><a href="#TramDagDataset-82"><span class="linenos"> 82</span></a><span class="sd">    - Intended for training data; `compute_scaling()` should use only training subsets.</span>
</span><span id="TramDagDataset-83"><a href="#TramDagDataset-83"><span class="linenos"> 83</span></a><span class="sd">    - Compatible with both CPU and GPU DataLoader options.</span>
</span><span id="TramDagDataset-84"><a href="#TramDagDataset-84"><span class="linenos"> 84</span></a><span class="sd">    - Strict validation of keyword arguments against `DEFAULTS` prevents silent misconfiguration.</span>
</span><span id="TramDagDataset-85"><a href="#TramDagDataset-85"><span class="linenos"> 85</span></a>
</span><span id="TramDagDataset-86"><a href="#TramDagDataset-86"><span class="linenos"> 86</span></a><span class="sd">    ---------------------------------------------------------------------</span>
</span><span id="TramDagDataset-87"><a href="#TramDagDataset-87"><span class="linenos"> 87</span></a><span class="sd">    Example</span>
</span><span id="TramDagDataset-88"><a href="#TramDagDataset-88"><span class="linenos"> 88</span></a><span class="sd">    ---------------------------------------------------------------------</span>
</span><span id="TramDagDataset-89"><a href="#TramDagDataset-89"><span class="linenos"> 89</span></a><span class="sd">    &gt;&gt;&gt; cfg = TramDagConfig.from_json(&quot;config.json&quot;)</span>
</span><span id="TramDagDataset-90"><a href="#TramDagDataset-90"><span class="linenos"> 90</span></a><span class="sd">    &gt;&gt;&gt; dataset = TramDagDataset.from_dataframe(train_df, cfg, batch_size=1024, debug=True)</span>
</span><span id="TramDagDataset-91"><a href="#TramDagDataset-91"><span class="linenos"> 91</span></a><span class="sd">    &gt;&gt;&gt; dataset.summary()</span>
</span><span id="TramDagDataset-92"><a href="#TramDagDataset-92"><span class="linenos"> 92</span></a><span class="sd">    &gt;&gt;&gt; minmax = dataset.compute_scaling(train_df)</span>
</span><span id="TramDagDataset-93"><a href="#TramDagDataset-93"><span class="linenos"> 93</span></a><span class="sd">    &gt;&gt;&gt; loader = dataset.loaders[&quot;variable_x&quot;]</span>
</span><span id="TramDagDataset-94"><a href="#TramDagDataset-94"><span class="linenos"> 94</span></a><span class="sd">    &gt;&gt;&gt; next(iter(loader))</span>
</span><span id="TramDagDataset-95"><a href="#TramDagDataset-95"><span class="linenos"> 95</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="TramDagDataset-96"><a href="#TramDagDataset-96"><span class="linenos"> 96</span></a>
</span><span id="TramDagDataset-97"><a href="#TramDagDataset-97"><span class="linenos"> 97</span></a>    <span class="n">DEFAULTS</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="TramDagDataset-98"><a href="#TramDagDataset-98"><span class="linenos"> 98</span></a>        <span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="mi">32_000</span><span class="p">,</span>
</span><span id="TramDagDataset-99"><a href="#TramDagDataset-99"><span class="linenos"> 99</span></a>        <span class="s2">&quot;shuffle&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="TramDagDataset-100"><a href="#TramDagDataset-100"><span class="linenos">100</span></a>        <span class="s2">&quot;num_workers&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="TramDagDataset-101"><a href="#TramDagDataset-101"><span class="linenos">101</span></a>        <span class="s2">&quot;pin_memory&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="TramDagDataset-102"><a href="#TramDagDataset-102"><span class="linenos">102</span></a>        <span class="s2">&quot;return_intercept_shift&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="TramDagDataset-103"><a href="#TramDagDataset-103"><span class="linenos">103</span></a>        <span class="s2">&quot;debug&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="TramDagDataset-104"><a href="#TramDagDataset-104"><span class="linenos">104</span></a>        <span class="s2">&quot;transform&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="TramDagDataset-105"><a href="#TramDagDataset-105"><span class="linenos">105</span></a>        <span class="s2">&quot;use_dataloader&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="TramDagDataset-106"><a href="#TramDagDataset-106"><span class="linenos">106</span></a>        <span class="s2">&quot;use_precomputed&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> 
</span><span id="TramDagDataset-107"><a href="#TramDagDataset-107"><span class="linenos">107</span></a>        <span class="c1"># DataLoader extras</span>
</span><span id="TramDagDataset-108"><a href="#TramDagDataset-108"><span class="linenos">108</span></a>        <span class="s2">&quot;sampler&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="TramDagDataset-109"><a href="#TramDagDataset-109"><span class="linenos">109</span></a>        <span class="s2">&quot;batch_sampler&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="TramDagDataset-110"><a href="#TramDagDataset-110"><span class="linenos">110</span></a>        <span class="s2">&quot;collate_fn&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="TramDagDataset-111"><a href="#TramDagDataset-111"><span class="linenos">111</span></a>        <span class="s2">&quot;drop_last&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="TramDagDataset-112"><a href="#TramDagDataset-112"><span class="linenos">112</span></a>        <span class="s2">&quot;timeout&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="TramDagDataset-113"><a href="#TramDagDataset-113"><span class="linenos">113</span></a>        <span class="s2">&quot;worker_init_fn&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="TramDagDataset-114"><a href="#TramDagDataset-114"><span class="linenos">114</span></a>        <span class="s2">&quot;multiprocessing_context&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="TramDagDataset-115"><a href="#TramDagDataset-115"><span class="linenos">115</span></a>        <span class="s2">&quot;generator&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="TramDagDataset-116"><a href="#TramDagDataset-116"><span class="linenos">116</span></a>        <span class="s2">&quot;prefetch_factor&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="TramDagDataset-117"><a href="#TramDagDataset-117"><span class="linenos">117</span></a>        <span class="s2">&quot;persistent_workers&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="TramDagDataset-118"><a href="#TramDagDataset-118"><span class="linenos">118</span></a>        <span class="s2">&quot;pin_memory_device&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="TramDagDataset-119"><a href="#TramDagDataset-119"><span class="linenos">119</span></a>    <span class="p">}</span>
</span><span id="TramDagDataset-120"><a href="#TramDagDataset-120"><span class="linenos">120</span></a>
</span><span id="TramDagDataset-121"><a href="#TramDagDataset-121"><span class="linenos">121</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TramDagDataset-122"><a href="#TramDagDataset-122"><span class="linenos">122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TramDagDataset-123"><a href="#TramDagDataset-123"><span class="linenos">123</span></a><span class="sd">        Initialize an empty TramDagDataset shell.</span>
</span><span id="TramDagDataset-124"><a href="#TramDagDataset-124"><span class="linenos">124</span></a>
</span><span id="TramDagDataset-125"><a href="#TramDagDataset-125"><span class="linenos">125</span></a><span class="sd">        Notes</span>
</span><span id="TramDagDataset-126"><a href="#TramDagDataset-126"><span class="linenos">126</span></a><span class="sd">        -----</span>
</span><span id="TramDagDataset-127"><a href="#TramDagDataset-127"><span class="linenos">127</span></a><span class="sd">        This constructor does not attach data or configuration. Use</span>
</span><span id="TramDagDataset-128"><a href="#TramDagDataset-128"><span class="linenos">128</span></a><span class="sd">        `TramDagDataset.from_dataframe` to obtain a ready-to-use instance.</span>
</span><span id="TramDagDataset-129"><a href="#TramDagDataset-129"><span class="linenos">129</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TramDagDataset-130"><a href="#TramDagDataset-130"><span class="linenos">130</span></a>        <span class="k">pass</span>
</span><span id="TramDagDataset-131"><a href="#TramDagDataset-131"><span class="linenos">131</span></a>
</span><span id="TramDagDataset-132"><a href="#TramDagDataset-132"><span class="linenos">132</span></a>    <span class="nd">@classmethod</span>
</span><span id="TramDagDataset-133"><a href="#TramDagDataset-133"><span class="linenos">133</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_dataframe</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="TramDagDataset-134"><a href="#TramDagDataset-134"><span class="linenos">134</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TramDagDataset-135"><a href="#TramDagDataset-135"><span class="linenos">135</span></a><span class="sd">        Create a TramDagDataset instance directly from a pandas DataFrame.</span>
</span><span id="TramDagDataset-136"><a href="#TramDagDataset-136"><span class="linenos">136</span></a>
</span><span id="TramDagDataset-137"><a href="#TramDagDataset-137"><span class="linenos">137</span></a><span class="sd">        This classmethod:</span>
</span><span id="TramDagDataset-138"><a href="#TramDagDataset-138"><span class="linenos">138</span></a>
</span><span id="TramDagDataset-139"><a href="#TramDagDataset-139"><span class="linenos">139</span></a><span class="sd">        1. Validates keyword arguments against `DEFAULTS`.</span>
</span><span id="TramDagDataset-140"><a href="#TramDagDataset-140"><span class="linenos">140</span></a><span class="sd">        2. Merges user overrides with defaults into a resolved settings dict.</span>
</span><span id="TramDagDataset-141"><a href="#TramDagDataset-141"><span class="linenos">141</span></a><span class="sd">        3. Stores the configuration and verifies its completeness.</span>
</span><span id="TramDagDataset-142"><a href="#TramDagDataset-142"><span class="linenos">142</span></a><span class="sd">        4. Applies settings to the instance.</span>
</span><span id="TramDagDataset-143"><a href="#TramDagDataset-143"><span class="linenos">143</span></a><span class="sd">        5. Builds per-node datasets and DataLoaders.</span>
</span><span id="TramDagDataset-144"><a href="#TramDagDataset-144"><span class="linenos">144</span></a>
</span><span id="TramDagDataset-145"><a href="#TramDagDataset-145"><span class="linenos">145</span></a><span class="sd">        Parameters</span>
</span><span id="TramDagDataset-146"><a href="#TramDagDataset-146"><span class="linenos">146</span></a><span class="sd">        ----------</span>
</span><span id="TramDagDataset-147"><a href="#TramDagDataset-147"><span class="linenos">147</span></a><span class="sd">        df : pandas.DataFrame</span>
</span><span id="TramDagDataset-148"><a href="#TramDagDataset-148"><span class="linenos">148</span></a><span class="sd">            Input DataFrame containing the dataset.</span>
</span><span id="TramDagDataset-149"><a href="#TramDagDataset-149"><span class="linenos">149</span></a><span class="sd">        cfg : TramDagConfig</span>
</span><span id="TramDagDataset-150"><a href="#TramDagDataset-150"><span class="linenos">150</span></a><span class="sd">            Configuration object defining nodes and variable metadata.</span>
</span><span id="TramDagDataset-151"><a href="#TramDagDataset-151"><span class="linenos">151</span></a><span class="sd">        **kwargs</span>
</span><span id="TramDagDataset-152"><a href="#TramDagDataset-152"><span class="linenos">152</span></a><span class="sd">            Optional overrides for `DEFAULTS`. All keys must exist in</span>
</span><span id="TramDagDataset-153"><a href="#TramDagDataset-153"><span class="linenos">153</span></a><span class="sd">            `TramDagDataset.DEFAULTS`. Common keys include:</span>
</span><span id="TramDagDataset-154"><a href="#TramDagDataset-154"><span class="linenos">154</span></a>
</span><span id="TramDagDataset-155"><a href="#TramDagDataset-155"><span class="linenos">155</span></a><span class="sd">            batch_size : int</span>
</span><span id="TramDagDataset-156"><a href="#TramDagDataset-156"><span class="linenos">156</span></a><span class="sd">                Batch size for DataLoaders.</span>
</span><span id="TramDagDataset-157"><a href="#TramDagDataset-157"><span class="linenos">157</span></a><span class="sd">            shuffle : bool</span>
</span><span id="TramDagDataset-158"><a href="#TramDagDataset-158"><span class="linenos">158</span></a><span class="sd">                Whether to shuffle samples per epoch.</span>
</span><span id="TramDagDataset-159"><a href="#TramDagDataset-159"><span class="linenos">159</span></a><span class="sd">            num_workers : int</span>
</span><span id="TramDagDataset-160"><a href="#TramDagDataset-160"><span class="linenos">160</span></a><span class="sd">                Number of DataLoader workers.</span>
</span><span id="TramDagDataset-161"><a href="#TramDagDataset-161"><span class="linenos">161</span></a><span class="sd">            pin_memory : bool</span>
</span><span id="TramDagDataset-162"><a href="#TramDagDataset-162"><span class="linenos">162</span></a><span class="sd">                Whether to pin memory for faster host-to-device transfers.</span>
</span><span id="TramDagDataset-163"><a href="#TramDagDataset-163"><span class="linenos">163</span></a><span class="sd">            return_intercept_shift : bool</span>
</span><span id="TramDagDataset-164"><a href="#TramDagDataset-164"><span class="linenos">164</span></a><span class="sd">                Whether datasets should return intercept/shift information.</span>
</span><span id="TramDagDataset-165"><a href="#TramDagDataset-165"><span class="linenos">165</span></a><span class="sd">            debug : bool</span>
</span><span id="TramDagDataset-166"><a href="#TramDagDataset-166"><span class="linenos">166</span></a><span class="sd">                Enable debug printing.</span>
</span><span id="TramDagDataset-167"><a href="#TramDagDataset-167"><span class="linenos">167</span></a><span class="sd">            transform : callable or dict or None</span>
</span><span id="TramDagDataset-168"><a href="#TramDagDataset-168"><span class="linenos">168</span></a><span class="sd">                Optional transform(s) applied to samples.</span>
</span><span id="TramDagDataset-169"><a href="#TramDagDataset-169"><span class="linenos">169</span></a><span class="sd">            use_dataloader : bool</span>
</span><span id="TramDagDataset-170"><a href="#TramDagDataset-170"><span class="linenos">170</span></a><span class="sd">                If True, construct DataLoaders; else store raw Dataset objects.</span>
</span><span id="TramDagDataset-171"><a href="#TramDagDataset-171"><span class="linenos">171</span></a><span class="sd">            use_precomputed : bool</span>
</span><span id="TramDagDataset-172"><a href="#TramDagDataset-172"><span class="linenos">172</span></a><span class="sd">                If True, precompute dataset representation to disk and reload it.</span>
</span><span id="TramDagDataset-173"><a href="#TramDagDataset-173"><span class="linenos">173</span></a>
</span><span id="TramDagDataset-174"><a href="#TramDagDataset-174"><span class="linenos">174</span></a><span class="sd">        Returns</span>
</span><span id="TramDagDataset-175"><a href="#TramDagDataset-175"><span class="linenos">175</span></a><span class="sd">        -------</span>
</span><span id="TramDagDataset-176"><a href="#TramDagDataset-176"><span class="linenos">176</span></a><span class="sd">        TramDagDataset</span>
</span><span id="TramDagDataset-177"><a href="#TramDagDataset-177"><span class="linenos">177</span></a><span class="sd">            Initialized dataset instance.</span>
</span><span id="TramDagDataset-178"><a href="#TramDagDataset-178"><span class="linenos">178</span></a>
</span><span id="TramDagDataset-179"><a href="#TramDagDataset-179"><span class="linenos">179</span></a><span class="sd">        Raises</span>
</span><span id="TramDagDataset-180"><a href="#TramDagDataset-180"><span class="linenos">180</span></a><span class="sd">        ------</span>
</span><span id="TramDagDataset-181"><a href="#TramDagDataset-181"><span class="linenos">181</span></a><span class="sd">        TypeError</span>
</span><span id="TramDagDataset-182"><a href="#TramDagDataset-182"><span class="linenos">182</span></a><span class="sd">            If `df` is not a pandas DataFrame.</span>
</span><span id="TramDagDataset-183"><a href="#TramDagDataset-183"><span class="linenos">183</span></a><span class="sd">        ValueError</span>
</span><span id="TramDagDataset-184"><a href="#TramDagDataset-184"><span class="linenos">184</span></a><span class="sd">            If unknown keyword arguments are provided (when validation is enabled).</span>
</span><span id="TramDagDataset-185"><a href="#TramDagDataset-185"><span class="linenos">185</span></a>
</span><span id="TramDagDataset-186"><a href="#TramDagDataset-186"><span class="linenos">186</span></a><span class="sd">        Notes</span>
</span><span id="TramDagDataset-187"><a href="#TramDagDataset-187"><span class="linenos">187</span></a><span class="sd">        -----</span>
</span><span id="TramDagDataset-188"><a href="#TramDagDataset-188"><span class="linenos">188</span></a><span class="sd">        If `shuffle=True` and the inferred variable name of `df` suggests</span>
</span><span id="TramDagDataset-189"><a href="#TramDagDataset-189"><span class="linenos">189</span></a><span class="sd">        validation/test data (e.g. &quot;val&quot;, &quot;test&quot;), a warning is printed.</span>
</span><span id="TramDagDataset-190"><a href="#TramDagDataset-190"><span class="linenos">190</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TramDagDataset-191"><a href="#TramDagDataset-191"><span class="linenos">191</span></a>        <span class="bp">self</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
</span><span id="TramDagDataset-192"><a href="#TramDagDataset-192"><span class="linenos">192</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="TramDagDataset-193"><a href="#TramDagDataset-193"><span class="linenos">193</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[ERROR] df must be a pandas DataFrame, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-194"><a href="#TramDagDataset-194"><span class="linenos">194</span></a>
</span><span id="TramDagDataset-195"><a href="#TramDagDataset-195"><span class="linenos">195</span></a>        <span class="c1"># validate kwargs</span>
</span><span id="TramDagDataset-196"><a href="#TramDagDataset-196"><span class="linenos">196</span></a>        <span class="c1"># TODO adjust validation such thath it works when called from tramdagmodel</span>
</span><span id="TramDagDataset-197"><a href="#TramDagDataset-197"><span class="linenos">197</span></a>        <span class="c1">#self._validate_kwargs(kwargs, context=&quot;from_dataframe&quot;)</span>
</span><span id="TramDagDataset-198"><a href="#TramDagDataset-198"><span class="linenos">198</span></a>        
</span><span id="TramDagDataset-199"><a href="#TramDagDataset-199"><span class="linenos">199</span></a>        <span class="c1"># merge defaults with overrides</span>
</span><span id="TramDagDataset-200"><a href="#TramDagDataset-200"><span class="linenos">200</span></a>        <span class="n">settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">DEFAULTS</span><span class="p">)</span>
</span><span id="TramDagDataset-201"><a href="#TramDagDataset-201"><span class="linenos">201</span></a>        <span class="n">settings</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="TramDagDataset-202"><a href="#TramDagDataset-202"><span class="linenos">202</span></a>
</span><span id="TramDagDataset-203"><a href="#TramDagDataset-203"><span class="linenos">203</span></a>        <span class="c1"># store config and verify</span>
</span><span id="TramDagDataset-204"><a href="#TramDagDataset-204"><span class="linenos">204</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span> <span class="o">=</span> <span class="n">cfg</span>
</span><span id="TramDagDataset-205"><a href="#TramDagDataset-205"><span class="linenos">205</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">_verify_completeness</span><span class="p">()</span>
</span><span id="TramDagDataset-206"><a href="#TramDagDataset-206"><span class="linenos">206</span></a>
</span><span id="TramDagDataset-207"><a href="#TramDagDataset-207"><span class="linenos">207</span></a>        <span class="c1"># ouptu all setttings if debug</span>
</span><span id="TramDagDataset-208"><a href="#TramDagDataset-208"><span class="linenos">208</span></a>        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="TramDagDataset-209"><a href="#TramDagDataset-209"><span class="linenos">209</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[DEBUG] TramDagDataset.from_dataframe() settings (after defaults + overrides):&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-210"><a href="#TramDagDataset-210"><span class="linenos">210</span></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="TramDagDataset-211"><a href="#TramDagDataset-211"><span class="linenos">211</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-212"><a href="#TramDagDataset-212"><span class="linenos">212</span></a>
</span><span id="TramDagDataset-213"><a href="#TramDagDataset-213"><span class="linenos">213</span></a>        <span class="c1"># infer variable name automatically</span>
</span><span id="TramDagDataset-214"><a href="#TramDagDataset-214"><span class="linenos">214</span></a>        <span class="n">callers_locals</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_back</span><span class="o">.</span><span class="n">f_locals</span>
</span><span id="TramDagDataset-215"><a href="#TramDagDataset-215"><span class="linenos">215</span></a>        <span class="n">inferred</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="TramDagDataset-216"><a href="#TramDagDataset-216"><span class="linenos">216</span></a>        <span class="k">for</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">var_val</span> <span class="ow">in</span> <span class="n">callers_locals</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="TramDagDataset-217"><a href="#TramDagDataset-217"><span class="linenos">217</span></a>            <span class="k">if</span> <span class="n">var_val</span> <span class="ow">is</span> <span class="n">df</span><span class="p">:</span>
</span><span id="TramDagDataset-218"><a href="#TramDagDataset-218"><span class="linenos">218</span></a>                <span class="n">inferred</span> <span class="o">=</span> <span class="n">var_name</span>
</span><span id="TramDagDataset-219"><a href="#TramDagDataset-219"><span class="linenos">219</span></a>                <span class="k">break</span>
</span><span id="TramDagDataset-220"><a href="#TramDagDataset-220"><span class="linenos">220</span></a>        <span class="n">df_name</span> <span class="o">=</span> <span class="n">inferred</span> <span class="ow">or</span> <span class="s2">&quot;dataframe&quot;</span>
</span><span id="TramDagDataset-221"><a href="#TramDagDataset-221"><span class="linenos">221</span></a>
</span><span id="TramDagDataset-222"><a href="#TramDagDataset-222"><span class="linenos">222</span></a>        <span class="k">if</span> <span class="n">settings</span><span class="p">[</span><span class="s2">&quot;shuffle&quot;</span><span class="p">]:</span>
</span><span id="TramDagDataset-223"><a href="#TramDagDataset-223"><span class="linenos">223</span></a>            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">df_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;val&quot;</span><span class="p">,</span> <span class="s2">&quot;validation&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">]):</span>
</span><span id="TramDagDataset-224"><a href="#TramDagDataset-224"><span class="linenos">224</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[WARNING] DataFrame &#39;</span><span class="si">{</span><span class="n">df_name</span><span class="si">}</span><span class="s2">&#39; looks like a validation/test set  shuffle=True. Are you sure?&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-225"><a href="#TramDagDataset-225"><span class="linenos">225</span></a>
</span><span id="TramDagDataset-226"><a href="#TramDagDataset-226"><span class="linenos">226</span></a>        <span class="c1"># call again to ensure Warning messages if ordinal vars have missing levels</span>
</span><span id="TramDagDataset-227"><a href="#TramDagDataset-227"><span class="linenos">227</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="TramDagDataset-228"><a href="#TramDagDataset-228"><span class="linenos">228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_settings</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
</span><span id="TramDagDataset-229"><a href="#TramDagDataset-229"><span class="linenos">229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_build_dataloaders</span><span class="p">()</span>
</span><span id="TramDagDataset-230"><a href="#TramDagDataset-230"><span class="linenos">230</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="TramDagDataset-231"><a href="#TramDagDataset-231"><span class="linenos">231</span></a>
</span><span id="TramDagDataset-232"><a href="#TramDagDataset-232"><span class="linenos">232</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">compute_scaling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">write</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="TramDagDataset-233"><a href="#TramDagDataset-233"><span class="linenos">233</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TramDagDataset-234"><a href="#TramDagDataset-234"><span class="linenos">234</span></a><span class="sd">        Compute variable-wise scaling parameters from data.</span>
</span><span id="TramDagDataset-235"><a href="#TramDagDataset-235"><span class="linenos">235</span></a>
</span><span id="TramDagDataset-236"><a href="#TramDagDataset-236"><span class="linenos">236</span></a><span class="sd">        Per variable, this method computes approximate minimum and maximum</span>
</span><span id="TramDagDataset-237"><a href="#TramDagDataset-237"><span class="linenos">237</span></a><span class="sd">        values using the 5th and 95th percentiles. This is typically used</span>
</span><span id="TramDagDataset-238"><a href="#TramDagDataset-238"><span class="linenos">238</span></a><span class="sd">        to derive robust normalization/clipping ranges from training data.</span>
</span><span id="TramDagDataset-239"><a href="#TramDagDataset-239"><span class="linenos">239</span></a>
</span><span id="TramDagDataset-240"><a href="#TramDagDataset-240"><span class="linenos">240</span></a><span class="sd">        Parameters</span>
</span><span id="TramDagDataset-241"><a href="#TramDagDataset-241"><span class="linenos">241</span></a><span class="sd">        ----------</span>
</span><span id="TramDagDataset-242"><a href="#TramDagDataset-242"><span class="linenos">242</span></a><span class="sd">        df : pandas.DataFrame or None, optional</span>
</span><span id="TramDagDataset-243"><a href="#TramDagDataset-243"><span class="linenos">243</span></a><span class="sd">            DataFrame used to compute scaling. If None, `self.df` is used.</span>
</span><span id="TramDagDataset-244"><a href="#TramDagDataset-244"><span class="linenos">244</span></a><span class="sd">        write : bool, optional</span>
</span><span id="TramDagDataset-245"><a href="#TramDagDataset-245"><span class="linenos">245</span></a><span class="sd">            Unused placeholder for interface compatibility with other components.</span>
</span><span id="TramDagDataset-246"><a href="#TramDagDataset-246"><span class="linenos">246</span></a><span class="sd">            Kept for potential future extensions. Default is True.</span>
</span><span id="TramDagDataset-247"><a href="#TramDagDataset-247"><span class="linenos">247</span></a>
</span><span id="TramDagDataset-248"><a href="#TramDagDataset-248"><span class="linenos">248</span></a><span class="sd">        Returns</span>
</span><span id="TramDagDataset-249"><a href="#TramDagDataset-249"><span class="linenos">249</span></a><span class="sd">        -------</span>
</span><span id="TramDagDataset-250"><a href="#TramDagDataset-250"><span class="linenos">250</span></a><span class="sd">        dict</span>
</span><span id="TramDagDataset-251"><a href="#TramDagDataset-251"><span class="linenos">251</span></a><span class="sd">            Mapping `{column_name: [min_value, max_value]}`, where values</span>
</span><span id="TramDagDataset-252"><a href="#TramDagDataset-252"><span class="linenos">252</span></a><span class="sd">            are derived from the 0.05 and 0.95 quantiles.</span>
</span><span id="TramDagDataset-253"><a href="#TramDagDataset-253"><span class="linenos">253</span></a>
</span><span id="TramDagDataset-254"><a href="#TramDagDataset-254"><span class="linenos">254</span></a><span class="sd">        Notes</span>
</span><span id="TramDagDataset-255"><a href="#TramDagDataset-255"><span class="linenos">255</span></a><span class="sd">        -----</span>
</span><span id="TramDagDataset-256"><a href="#TramDagDataset-256"><span class="linenos">256</span></a><span class="sd">        If `self.debug` is True, the method emits debug messages about the</span>
</span><span id="TramDagDataset-257"><a href="#TramDagDataset-257"><span class="linenos">257</span></a><span class="sd">        data source. Only training data should be used to avoid leakage.</span>
</span><span id="TramDagDataset-258"><a href="#TramDagDataset-258"><span class="linenos">258</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TramDagDataset-259"><a href="#TramDagDataset-259"><span class="linenos">259</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
</span><span id="TramDagDataset-260"><a href="#TramDagDataset-260"><span class="linenos">260</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[DEBUG] Make sure to provide only training data to compute_scaling!&quot;</span><span class="p">)</span>     
</span><span id="TramDagDataset-261"><a href="#TramDagDataset-261"><span class="linenos">261</span></a>        <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TramDagDataset-262"><a href="#TramDagDataset-262"><span class="linenos">262</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span>
</span><span id="TramDagDataset-263"><a href="#TramDagDataset-263"><span class="linenos">263</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
</span><span id="TramDagDataset-264"><a href="#TramDagDataset-264"><span class="linenos">264</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[DEBUG] No DataFrame provided, using internal df.&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-265"><a href="#TramDagDataset-265"><span class="linenos">265</span></a>        <span class="n">quantiles</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
</span><span id="TramDagDataset-266"><a href="#TramDagDataset-266"><span class="linenos">266</span></a>        <span class="n">min_vals</span> <span class="o">=</span> <span class="n">quantiles</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">0.05</span><span class="p">]</span>
</span><span id="TramDagDataset-267"><a href="#TramDagDataset-267"><span class="linenos">267</span></a>        <span class="n">max_vals</span> <span class="o">=</span> <span class="n">quantiles</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">0.95</span><span class="p">]</span>
</span><span id="TramDagDataset-268"><a href="#TramDagDataset-268"><span class="linenos">268</span></a>        <span class="n">minmax_dict</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">min_vals</span><span class="p">,</span> <span class="n">max_vals</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>
</span><span id="TramDagDataset-269"><a href="#TramDagDataset-269"><span class="linenos">269</span></a>        <span class="k">return</span> <span class="n">minmax_dict</span>
</span><span id="TramDagDataset-270"><a href="#TramDagDataset-270"><span class="linenos">270</span></a>
</span><span id="TramDagDataset-271"><a href="#TramDagDataset-271"><span class="linenos">271</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TramDagDataset-272"><a href="#TramDagDataset-272"><span class="linenos">272</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TramDagDataset-273"><a href="#TramDagDataset-273"><span class="linenos">273</span></a><span class="sd">        Print a structured overview of the dataset and configuration.</span>
</span><span id="TramDagDataset-274"><a href="#TramDagDataset-274"><span class="linenos">274</span></a>
</span><span id="TramDagDataset-275"><a href="#TramDagDataset-275"><span class="linenos">275</span></a><span class="sd">        The summary includes:</span>
</span><span id="TramDagDataset-276"><a href="#TramDagDataset-276"><span class="linenos">276</span></a>
</span><span id="TramDagDataset-277"><a href="#TramDagDataset-277"><span class="linenos">277</span></a><span class="sd">        1. DataFrame information:</span>
</span><span id="TramDagDataset-278"><a href="#TramDagDataset-278"><span class="linenos">278</span></a><span class="sd">        - Shape</span>
</span><span id="TramDagDataset-279"><a href="#TramDagDataset-279"><span class="linenos">279</span></a><span class="sd">        - Columns</span>
</span><span id="TramDagDataset-280"><a href="#TramDagDataset-280"><span class="linenos">280</span></a><span class="sd">        - Head (first rows)</span>
</span><span id="TramDagDataset-281"><a href="#TramDagDataset-281"><span class="linenos">281</span></a><span class="sd">        - Dtypes</span>
</span><span id="TramDagDataset-282"><a href="#TramDagDataset-282"><span class="linenos">282</span></a><span class="sd">        - Descriptive statistics</span>
</span><span id="TramDagDataset-283"><a href="#TramDagDataset-283"><span class="linenos">283</span></a>
</span><span id="TramDagDataset-284"><a href="#TramDagDataset-284"><span class="linenos">284</span></a><span class="sd">        2. Configuration overview:</span>
</span><span id="TramDagDataset-285"><a href="#TramDagDataset-285"><span class="linenos">285</span></a><span class="sd">        - Number of nodes</span>
</span><span id="TramDagDataset-286"><a href="#TramDagDataset-286"><span class="linenos">286</span></a><span class="sd">        - Loader mode (DataLoader vs. raw Dataset)</span>
</span><span id="TramDagDataset-287"><a href="#TramDagDataset-287"><span class="linenos">287</span></a><span class="sd">        - Precomputation status</span>
</span><span id="TramDagDataset-288"><a href="#TramDagDataset-288"><span class="linenos">288</span></a>
</span><span id="TramDagDataset-289"><a href="#TramDagDataset-289"><span class="linenos">289</span></a><span class="sd">        3. Node settings:</span>
</span><span id="TramDagDataset-290"><a href="#TramDagDataset-290"><span class="linenos">290</span></a><span class="sd">        - Batch size</span>
</span><span id="TramDagDataset-291"><a href="#TramDagDataset-291"><span class="linenos">291</span></a><span class="sd">        - Shuffle flag</span>
</span><span id="TramDagDataset-292"><a href="#TramDagDataset-292"><span class="linenos">292</span></a><span class="sd">        - num_workers</span>
</span><span id="TramDagDataset-293"><a href="#TramDagDataset-293"><span class="linenos">293</span></a><span class="sd">        - pin_memory</span>
</span><span id="TramDagDataset-294"><a href="#TramDagDataset-294"><span class="linenos">294</span></a><span class="sd">        - return_intercept_shift</span>
</span><span id="TramDagDataset-295"><a href="#TramDagDataset-295"><span class="linenos">295</span></a><span class="sd">        - debug</span>
</span><span id="TramDagDataset-296"><a href="#TramDagDataset-296"><span class="linenos">296</span></a><span class="sd">        - transform</span>
</span><span id="TramDagDataset-297"><a href="#TramDagDataset-297"><span class="linenos">297</span></a>
</span><span id="TramDagDataset-298"><a href="#TramDagDataset-298"><span class="linenos">298</span></a><span class="sd">        4. DataLoader overview:</span>
</span><span id="TramDagDataset-299"><a href="#TramDagDataset-299"><span class="linenos">299</span></a><span class="sd">        - Type and length of each loader.</span>
</span><span id="TramDagDataset-300"><a href="#TramDagDataset-300"><span class="linenos">300</span></a>
</span><span id="TramDagDataset-301"><a href="#TramDagDataset-301"><span class="linenos">301</span></a><span class="sd">        Parameters</span>
</span><span id="TramDagDataset-302"><a href="#TramDagDataset-302"><span class="linenos">302</span></a><span class="sd">        ----------</span>
</span><span id="TramDagDataset-303"><a href="#TramDagDataset-303"><span class="linenos">303</span></a><span class="sd">        None</span>
</span><span id="TramDagDataset-304"><a href="#TramDagDataset-304"><span class="linenos">304</span></a>
</span><span id="TramDagDataset-305"><a href="#TramDagDataset-305"><span class="linenos">305</span></a><span class="sd">        Returns</span>
</span><span id="TramDagDataset-306"><a href="#TramDagDataset-306"><span class="linenos">306</span></a><span class="sd">        -------</span>
</span><span id="TramDagDataset-307"><a href="#TramDagDataset-307"><span class="linenos">307</span></a><span class="sd">        None</span>
</span><span id="TramDagDataset-308"><a href="#TramDagDataset-308"><span class="linenos">308</span></a>
</span><span id="TramDagDataset-309"><a href="#TramDagDataset-309"><span class="linenos">309</span></a><span class="sd">        Notes</span>
</span><span id="TramDagDataset-310"><a href="#TramDagDataset-310"><span class="linenos">310</span></a><span class="sd">        -----</span>
</span><span id="TramDagDataset-311"><a href="#TramDagDataset-311"><span class="linenos">311</span></a><span class="sd">        Intended for quick inspection and debugging. Uses `print` statements</span>
</span><span id="TramDagDataset-312"><a href="#TramDagDataset-312"><span class="linenos">312</span></a><span class="sd">        and does not return structured metadata.</span>
</span><span id="TramDagDataset-313"><a href="#TramDagDataset-313"><span class="linenos">313</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TramDagDataset-314"><a href="#TramDagDataset-314"><span class="linenos">314</span></a>        
</span><span id="TramDagDataset-315"><a href="#TramDagDataset-315"><span class="linenos">315</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[TramDagDataset Summary]&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-316"><a href="#TramDagDataset-316"><span class="linenos">316</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
</span><span id="TramDagDataset-317"><a href="#TramDagDataset-317"><span class="linenos">317</span></a>
</span><span id="TramDagDataset-318"><a href="#TramDagDataset-318"><span class="linenos">318</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[DataFrame]&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-319"><a href="#TramDagDataset-319"><span class="linenos">319</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="TramDagDataset-320"><a href="#TramDagDataset-320"><span class="linenos">320</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Columns:&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
</span><span id="TramDagDataset-321"><a href="#TramDagDataset-321"><span class="linenos">321</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Head:&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-322"><a href="#TramDagDataset-322"><span class="linenos">322</span></a>        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</span><span id="TramDagDataset-323"><a href="#TramDagDataset-323"><span class="linenos">323</span></a>
</span><span id="TramDagDataset-324"><a href="#TramDagDataset-324"><span class="linenos">324</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Dtypes:&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-325"><a href="#TramDagDataset-325"><span class="linenos">325</span></a>        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</span><span id="TramDagDataset-326"><a href="#TramDagDataset-326"><span class="linenos">326</span></a>
</span><span id="TramDagDataset-327"><a href="#TramDagDataset-327"><span class="linenos">327</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Describe:&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-328"><a href="#TramDagDataset-328"><span class="linenos">328</span></a>        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">))</span>
</span><span id="TramDagDataset-329"><a href="#TramDagDataset-329"><span class="linenos">329</span></a>
</span><span id="TramDagDataset-330"><a href="#TramDagDataset-330"><span class="linenos">330</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[Configuration]&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-331"><a href="#TramDagDataset-331"><span class="linenos">331</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nodes: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-332"><a href="#TramDagDataset-332"><span class="linenos">332</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loader mode: </span><span class="si">{</span><span class="s1">&#39;DataLoader&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">use_dataloader</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Direct dataset&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-333"><a href="#TramDagDataset-333"><span class="linenos">333</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precomputed: </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;use_precomputed&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">False</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-334"><a href="#TramDagDataset-334"><span class="linenos">334</span></a>
</span><span id="TramDagDataset-335"><a href="#TramDagDataset-335"><span class="linenos">335</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[Node Settings]&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-336"><a href="#TramDagDataset-336"><span class="linenos">336</span></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="TramDagDataset-337"><a href="#TramDagDataset-337"><span class="linenos">337</span></a>            <span class="n">batch_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span>
</span><span id="TramDagDataset-338"><a href="#TramDagDataset-338"><span class="linenos">338</span></a>            <span class="n">shuffle_flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span>
</span><span id="TramDagDataset-339"><a href="#TramDagDataset-339"><span class="linenos">339</span></a>            <span class="n">num_workers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span>
</span><span id="TramDagDataset-340"><a href="#TramDagDataset-340"><span class="linenos">340</span></a>            <span class="n">pin_memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin_memory</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pin_memory</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin_memory</span>
</span><span id="TramDagDataset-341"><a href="#TramDagDataset-341"><span class="linenos">341</span></a>            <span class="n">rshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_intercept_shift</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">return_intercept_shift</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_intercept_shift</span>
</span><span id="TramDagDataset-342"><a href="#TramDagDataset-342"><span class="linenos">342</span></a>            <span class="n">debug_flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span>
</span><span id="TramDagDataset-343"><a href="#TramDagDataset-343"><span class="linenos">343</span></a>            <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span>
</span><span id="TramDagDataset-344"><a href="#TramDagDataset-344"><span class="linenos">344</span></a>
</span><span id="TramDagDataset-345"><a href="#TramDagDataset-345"><span class="linenos">345</span></a>            <span class="nb">print</span><span class="p">(</span>
</span><span id="TramDagDataset-346"><a href="#TramDagDataset-346"><span class="linenos">346</span></a>                <span class="sa">f</span><span class="s2">&quot; Node &#39;</span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">&#39;: &quot;</span>
</span><span id="TramDagDataset-347"><a href="#TramDagDataset-347"><span class="linenos">347</span></a>                <span class="sa">f</span><span class="s2">&quot;batch_size=</span><span class="si">{</span><span class="n">batch_size</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="TramDagDataset-348"><a href="#TramDagDataset-348"><span class="linenos">348</span></a>                <span class="sa">f</span><span class="s2">&quot;shuffle=</span><span class="si">{</span><span class="n">shuffle_flag</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="TramDagDataset-349"><a href="#TramDagDataset-349"><span class="linenos">349</span></a>                <span class="sa">f</span><span class="s2">&quot;num_workers=</span><span class="si">{</span><span class="n">num_workers</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="TramDagDataset-350"><a href="#TramDagDataset-350"><span class="linenos">350</span></a>                <span class="sa">f</span><span class="s2">&quot;pin_memory=</span><span class="si">{</span><span class="n">pin_memory</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="TramDagDataset-351"><a href="#TramDagDataset-351"><span class="linenos">351</span></a>                <span class="sa">f</span><span class="s2">&quot;return_intercept_shift=</span><span class="si">{</span><span class="n">rshift</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="TramDagDataset-352"><a href="#TramDagDataset-352"><span class="linenos">352</span></a>                <span class="sa">f</span><span class="s2">&quot;debug=</span><span class="si">{</span><span class="n">debug_flag</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="TramDagDataset-353"><a href="#TramDagDataset-353"><span class="linenos">353</span></a>                <span class="sa">f</span><span class="s2">&quot;transform=</span><span class="si">{</span><span class="n">transform</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="TramDagDataset-354"><a href="#TramDagDataset-354"><span class="linenos">354</span></a>            <span class="p">)</span>
</span><span id="TramDagDataset-355"><a href="#TramDagDataset-355"><span class="linenos">355</span></a>
</span><span id="TramDagDataset-356"><a href="#TramDagDataset-356"><span class="linenos">356</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;loaders&quot;</span><span class="p">):</span>
</span><span id="TramDagDataset-357"><a href="#TramDagDataset-357"><span class="linenos">357</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[DataLoaders]&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-358"><a href="#TramDagDataset-358"><span class="linenos">358</span></a>            <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">loader</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaders</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="TramDagDataset-359"><a href="#TramDagDataset-359"><span class="linenos">359</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="TramDagDataset-360"><a href="#TramDagDataset-360"><span class="linenos">360</span></a>                    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">loader</span><span class="p">)</span>
</span><span id="TramDagDataset-361"><a href="#TramDagDataset-361"><span class="linenos">361</span></a>                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="TramDagDataset-362"><a href="#TramDagDataset-362"><span class="linenos">362</span></a>                    <span class="n">length</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span>
</span><span id="TramDagDataset-363"><a href="#TramDagDataset-363"><span class="linenos">363</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">loader</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">, len=</span><span class="si">{</span><span class="n">length</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-364"><a href="#TramDagDataset-364"><span class="linenos">364</span></a>
</span><span id="TramDagDataset-365"><a href="#TramDagDataset-365"><span class="linenos">365</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-366"><a href="#TramDagDataset-366"><span class="linenos">366</span></a>
</span><span id="TramDagDataset-367"><a href="#TramDagDataset-367"><span class="linenos">367</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">defaults_attr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;DEFAULTS&quot;</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="TramDagDataset-368"><a href="#TramDagDataset-368"><span class="linenos">368</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TramDagDataset-369"><a href="#TramDagDataset-369"><span class="linenos">369</span></a><span class="sd">        Validate keyword arguments against a defaults dictionary.</span>
</span><span id="TramDagDataset-370"><a href="#TramDagDataset-370"><span class="linenos">370</span></a>
</span><span id="TramDagDataset-371"><a href="#TramDagDataset-371"><span class="linenos">371</span></a><span class="sd">        Parameters</span>
</span><span id="TramDagDataset-372"><a href="#TramDagDataset-372"><span class="linenos">372</span></a><span class="sd">        ----------</span>
</span><span id="TramDagDataset-373"><a href="#TramDagDataset-373"><span class="linenos">373</span></a><span class="sd">        kwargs : dict</span>
</span><span id="TramDagDataset-374"><a href="#TramDagDataset-374"><span class="linenos">374</span></a><span class="sd">            Keyword arguments to validate.</span>
</span><span id="TramDagDataset-375"><a href="#TramDagDataset-375"><span class="linenos">375</span></a><span class="sd">        defaults_attr : str, optional</span>
</span><span id="TramDagDataset-376"><a href="#TramDagDataset-376"><span class="linenos">376</span></a><span class="sd">            Name of the attribute on this class containing the default keys</span>
</span><span id="TramDagDataset-377"><a href="#TramDagDataset-377"><span class="linenos">377</span></a><span class="sd">            (e.g. &quot;DEFAULTS&quot;). Default is &quot;DEFAULTS&quot;.</span>
</span><span id="TramDagDataset-378"><a href="#TramDagDataset-378"><span class="linenos">378</span></a><span class="sd">        context : str or None, optional</span>
</span><span id="TramDagDataset-379"><a href="#TramDagDataset-379"><span class="linenos">379</span></a><span class="sd">            Optional context label (e.g. caller name) included in error messages.</span>
</span><span id="TramDagDataset-380"><a href="#TramDagDataset-380"><span class="linenos">380</span></a>
</span><span id="TramDagDataset-381"><a href="#TramDagDataset-381"><span class="linenos">381</span></a><span class="sd">        Raises</span>
</span><span id="TramDagDataset-382"><a href="#TramDagDataset-382"><span class="linenos">382</span></a><span class="sd">        ------</span>
</span><span id="TramDagDataset-383"><a href="#TramDagDataset-383"><span class="linenos">383</span></a><span class="sd">        AttributeError</span>
</span><span id="TramDagDataset-384"><a href="#TramDagDataset-384"><span class="linenos">384</span></a><span class="sd">            If the attribute named by `defaults_attr` does not exist.</span>
</span><span id="TramDagDataset-385"><a href="#TramDagDataset-385"><span class="linenos">385</span></a><span class="sd">        ValueError</span>
</span><span id="TramDagDataset-386"><a href="#TramDagDataset-386"><span class="linenos">386</span></a><span class="sd">            If any keys in `kwargs` are not present in the defaults dictionary.</span>
</span><span id="TramDagDataset-387"><a href="#TramDagDataset-387"><span class="linenos">387</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TramDagDataset-388"><a href="#TramDagDataset-388"><span class="linenos">388</span></a>        <span class="n">defaults</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">defaults_attr</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="TramDagDataset-389"><a href="#TramDagDataset-389"><span class="linenos">389</span></a>        <span class="k">if</span> <span class="n">defaults</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TramDagDataset-390"><a href="#TramDagDataset-390"><span class="linenos">390</span></a>            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> has no attribute &#39;</span><span class="si">{</span><span class="n">defaults_attr</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-391"><a href="#TramDagDataset-391"><span class="linenos">391</span></a>
</span><span id="TramDagDataset-392"><a href="#TramDagDataset-392"><span class="linenos">392</span></a>        <span class="n">unknown</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">defaults</span><span class="p">)</span>
</span><span id="TramDagDataset-393"><a href="#TramDagDataset-393"><span class="linenos">393</span></a>        <span class="k">if</span> <span class="n">unknown</span><span class="p">:</span>
</span><span id="TramDagDataset-394"><a href="#TramDagDataset-394"><span class="linenos">394</span></a>            <span class="n">prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">] &quot;</span> <span class="k">if</span> <span class="n">context</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
</span><span id="TramDagDataset-395"><a href="#TramDagDataset-395"><span class="linenos">395</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">Unknown parameter(s): </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">unknown</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-396"><a href="#TramDagDataset-396"><span class="linenos">396</span></a>
</span><span id="TramDagDataset-397"><a href="#TramDagDataset-397"><span class="linenos">397</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">settings</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="TramDagDataset-398"><a href="#TramDagDataset-398"><span class="linenos">398</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TramDagDataset-399"><a href="#TramDagDataset-399"><span class="linenos">399</span></a><span class="sd">        Apply resolved settings to the dataset instance.</span>
</span><span id="TramDagDataset-400"><a href="#TramDagDataset-400"><span class="linenos">400</span></a>
</span><span id="TramDagDataset-401"><a href="#TramDagDataset-401"><span class="linenos">401</span></a><span class="sd">        This method:</span>
</span><span id="TramDagDataset-402"><a href="#TramDagDataset-402"><span class="linenos">402</span></a>
</span><span id="TramDagDataset-403"><a href="#TramDagDataset-403"><span class="linenos">403</span></a><span class="sd">        1. Stores all keyvalue pairs from `settings` as attributes on `self`.</span>
</span><span id="TramDagDataset-404"><a href="#TramDagDataset-404"><span class="linenos">404</span></a><span class="sd">        2. Extracts `nodes_dict` from the configuration.</span>
</span><span id="TramDagDataset-405"><a href="#TramDagDataset-405"><span class="linenos">405</span></a><span class="sd">        3. Validates that dict-valued core attributes (batch_size, shuffle, etc.)</span>
</span><span id="TramDagDataset-406"><a href="#TramDagDataset-406"><span class="linenos">406</span></a><span class="sd">        have keys matching the node set.</span>
</span><span id="TramDagDataset-407"><a href="#TramDagDataset-407"><span class="linenos">407</span></a>
</span><span id="TramDagDataset-408"><a href="#TramDagDataset-408"><span class="linenos">408</span></a><span class="sd">        Parameters</span>
</span><span id="TramDagDataset-409"><a href="#TramDagDataset-409"><span class="linenos">409</span></a><span class="sd">        ----------</span>
</span><span id="TramDagDataset-410"><a href="#TramDagDataset-410"><span class="linenos">410</span></a><span class="sd">        settings : dict</span>
</span><span id="TramDagDataset-411"><a href="#TramDagDataset-411"><span class="linenos">411</span></a><span class="sd">            Resolved settings dictionary, usually built from `DEFAULTS` plus</span>
</span><span id="TramDagDataset-412"><a href="#TramDagDataset-412"><span class="linenos">412</span></a><span class="sd">            user overrides.</span>
</span><span id="TramDagDataset-413"><a href="#TramDagDataset-413"><span class="linenos">413</span></a>
</span><span id="TramDagDataset-414"><a href="#TramDagDataset-414"><span class="linenos">414</span></a><span class="sd">        Returns</span>
</span><span id="TramDagDataset-415"><a href="#TramDagDataset-415"><span class="linenos">415</span></a><span class="sd">        -------</span>
</span><span id="TramDagDataset-416"><a href="#TramDagDataset-416"><span class="linenos">416</span></a><span class="sd">        None</span>
</span><span id="TramDagDataset-417"><a href="#TramDagDataset-417"><span class="linenos">417</span></a>
</span><span id="TramDagDataset-418"><a href="#TramDagDataset-418"><span class="linenos">418</span></a><span class="sd">        Raises</span>
</span><span id="TramDagDataset-419"><a href="#TramDagDataset-419"><span class="linenos">419</span></a><span class="sd">        ------</span>
</span><span id="TramDagDataset-420"><a href="#TramDagDataset-420"><span class="linenos">420</span></a><span class="sd">        ValueError</span>
</span><span id="TramDagDataset-421"><a href="#TramDagDataset-421"><span class="linenos">421</span></a><span class="sd">            If any dict-valued core attribute has keys that do not match</span>
</span><span id="TramDagDataset-422"><a href="#TramDagDataset-422"><span class="linenos">422</span></a><span class="sd">            `cfg.conf_dict[&quot;nodes&quot;].keys()`.</span>
</span><span id="TramDagDataset-423"><a href="#TramDagDataset-423"><span class="linenos">423</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TramDagDataset-424"><a href="#TramDagDataset-424"><span class="linenos">424</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="TramDagDataset-425"><a href="#TramDagDataset-425"><span class="linenos">425</span></a>            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span><span id="TramDagDataset-426"><a href="#TramDagDataset-426"><span class="linenos">426</span></a>
</span><span id="TramDagDataset-427"><a href="#TramDagDataset-427"><span class="linenos">427</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">conf_dict</span><span class="p">[</span><span class="s2">&quot;nodes&quot;</span><span class="p">]</span>
</span><span id="TramDagDataset-428"><a href="#TramDagDataset-428"><span class="linenos">428</span></a>
</span><span id="TramDagDataset-429"><a href="#TramDagDataset-429"><span class="linenos">429</span></a>        <span class="c1"># validate only the most important ones</span>
</span><span id="TramDagDataset-430"><a href="#TramDagDataset-430"><span class="linenos">430</span></a>        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;batch_size&quot;</span><span class="p">,</span> <span class="s2">&quot;shuffle&quot;</span><span class="p">,</span> <span class="s2">&quot;num_workers&quot;</span><span class="p">,</span> <span class="s2">&quot;pin_memory&quot;</span><span class="p">,</span>
</span><span id="TramDagDataset-431"><a href="#TramDagDataset-431"><span class="linenos">431</span></a>                     <span class="s2">&quot;return_intercept_shift&quot;</span><span class="p">,</span> <span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="s2">&quot;transform&quot;</span><span class="p">]:</span>
</span><span id="TramDagDataset-432"><a href="#TramDagDataset-432"><span class="linenos">432</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_check_keys</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
</span><span id="TramDagDataset-433"><a href="#TramDagDataset-433"><span class="linenos">433</span></a>
</span><span id="TramDagDataset-434"><a href="#TramDagDataset-434"><span class="linenos">434</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_build_dataloaders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TramDagDataset-435"><a href="#TramDagDataset-435"><span class="linenos">435</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build node-specific dataloaders or raw datasets depending on settings.&quot;&quot;&quot;</span>
</span><span id="TramDagDataset-436"><a href="#TramDagDataset-436"><span class="linenos">436</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">loaders</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="TramDagDataset-437"><a href="#TramDagDataset-437"><span class="linenos">437</span></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">:</span>
</span><span id="TramDagDataset-438"><a href="#TramDagDataset-438"><span class="linenos">438</span></a>            <span class="n">ds</span> <span class="o">=</span> <span class="n">GenericDataset</span><span class="p">(</span>
</span><span id="TramDagDataset-439"><a href="#TramDagDataset-439"><span class="linenos">439</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span>
</span><span id="TramDagDataset-440"><a href="#TramDagDataset-440"><span class="linenos">440</span></a>                <span class="n">target_col</span><span class="o">=</span><span class="n">node</span><span class="p">,</span>
</span><span id="TramDagDataset-441"><a href="#TramDagDataset-441"><span class="linenos">441</span></a>                <span class="n">target_nodes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">,</span>
</span><span id="TramDagDataset-442"><a href="#TramDagDataset-442"><span class="linenos">442</span></a>                <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">[</span><span class="n">node</span><span class="p">],</span>
</span><span id="TramDagDataset-443"><a href="#TramDagDataset-443"><span class="linenos">443</span></a>                <span class="n">return_intercept_shift</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">return_intercept_shift</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">return_intercept_shift</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_intercept_shift</span><span class="p">[</span><span class="n">node</span><span class="p">],</span>
</span><span id="TramDagDataset-444"><a href="#TramDagDataset-444"><span class="linenos">444</span></a>                <span class="n">debug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">[</span><span class="n">node</span><span class="p">],</span>
</span><span id="TramDagDataset-445"><a href="#TramDagDataset-445"><span class="linenos">445</span></a>            <span class="p">)</span>
</span><span id="TramDagDataset-446"><a href="#TramDagDataset-446"><span class="linenos">446</span></a>
</span><span id="TramDagDataset-447"><a href="#TramDagDataset-447"><span class="linenos">447</span></a>        <span class="c1">########## QUICK PATCH </span>
</span><span id="TramDagDataset-448"><a href="#TramDagDataset-448"><span class="linenos">448</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;use_precomputed&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_precomputed</span><span class="p">:</span>
</span><span id="TramDagDataset-449"><a href="#TramDagDataset-449"><span class="linenos">449</span></a>                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;temp&quot;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
</span><span id="TramDagDataset-450"><a href="#TramDagDataset-450"><span class="linenos">450</span></a>                <span class="n">pth</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;temp&quot;</span><span class="p">,</span> <span class="s2">&quot;precomputed.pt&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-451"><a href="#TramDagDataset-451"><span class="linenos">451</span></a>
</span><span id="TramDagDataset-452"><a href="#TramDagDataset-452"><span class="linenos">452</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s2">&quot;save_precomputed&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="s2">&quot;save_precomputed&quot;</span><span class="p">)):</span>
</span><span id="TramDagDataset-453"><a href="#TramDagDataset-453"><span class="linenos">453</span></a>                    <span class="n">ds</span><span class="o">.</span><span class="n">save_precomputed</span><span class="p">(</span><span class="n">pth</span><span class="p">)</span>
</span><span id="TramDagDataset-454"><a href="#TramDagDataset-454"><span class="linenos">454</span></a>                    <span class="n">ds</span> <span class="o">=</span> <span class="n">GenericDatasetPrecomputed</span><span class="p">(</span><span class="n">pth</span><span class="p">)</span>
</span><span id="TramDagDataset-455"><a href="#TramDagDataset-455"><span class="linenos">455</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="TramDagDataset-456"><a href="#TramDagDataset-456"><span class="linenos">456</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[WARNING] Dataset has no &#39;save_precomputed()&#39; method  skipping precomputation.&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-457"><a href="#TramDagDataset-457"><span class="linenos">457</span></a>
</span><span id="TramDagDataset-458"><a href="#TramDagDataset-458"><span class="linenos">458</span></a>
</span><span id="TramDagDataset-459"><a href="#TramDagDataset-459"><span class="linenos">459</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_dataloader</span><span class="p">:</span>
</span><span id="TramDagDataset-460"><a href="#TramDagDataset-460"><span class="linenos">460</span></a>                <span class="c1"># resolve per-node overrides</span>
</span><span id="TramDagDataset-461"><a href="#TramDagDataset-461"><span class="linenos">461</span></a>                <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="TramDagDataset-462"><a href="#TramDagDataset-462"><span class="linenos">462</span></a>                    <span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span>
</span><span id="TramDagDataset-463"><a href="#TramDagDataset-463"><span class="linenos">463</span></a>                    <span class="s2">&quot;shuffle&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span><span class="p">,</span>
</span><span id="TramDagDataset-464"><a href="#TramDagDataset-464"><span class="linenos">464</span></a>                    <span class="s2">&quot;num_workers&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">,</span>
</span><span id="TramDagDataset-465"><a href="#TramDagDataset-465"><span class="linenos">465</span></a>                    <span class="s2">&quot;pin_memory&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin_memory</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pin_memory</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin_memory</span><span class="p">,</span>
</span><span id="TramDagDataset-466"><a href="#TramDagDataset-466"><span class="linenos">466</span></a>                    <span class="s2">&quot;sampler&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampler</span><span class="p">,</span>
</span><span id="TramDagDataset-467"><a href="#TramDagDataset-467"><span class="linenos">467</span></a>                    <span class="s2">&quot;batch_sampler&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_sampler</span><span class="p">,</span>
</span><span id="TramDagDataset-468"><a href="#TramDagDataset-468"><span class="linenos">468</span></a>                    <span class="s2">&quot;collate_fn&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">collate_fn</span><span class="p">,</span>
</span><span id="TramDagDataset-469"><a href="#TramDagDataset-469"><span class="linenos">469</span></a>                    <span class="s2">&quot;drop_last&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">drop_last</span><span class="p">,</span>
</span><span id="TramDagDataset-470"><a href="#TramDagDataset-470"><span class="linenos">470</span></a>                    <span class="s2">&quot;timeout&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span>
</span><span id="TramDagDataset-471"><a href="#TramDagDataset-471"><span class="linenos">471</span></a>                    <span class="s2">&quot;worker_init_fn&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">worker_init_fn</span><span class="p">,</span>
</span><span id="TramDagDataset-472"><a href="#TramDagDataset-472"><span class="linenos">472</span></a>                    <span class="s2">&quot;multiprocessing_context&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiprocessing_context</span><span class="p">,</span>
</span><span id="TramDagDataset-473"><a href="#TramDagDataset-473"><span class="linenos">473</span></a>                    <span class="s2">&quot;generator&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="p">,</span>
</span><span id="TramDagDataset-474"><a href="#TramDagDataset-474"><span class="linenos">474</span></a>                    <span class="s2">&quot;prefetch_factor&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefetch_factor</span><span class="p">,</span>
</span><span id="TramDagDataset-475"><a href="#TramDagDataset-475"><span class="linenos">475</span></a>                    <span class="s2">&quot;persistent_workers&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">persistent_workers</span><span class="p">,</span>
</span><span id="TramDagDataset-476"><a href="#TramDagDataset-476"><span class="linenos">476</span></a>                    <span class="s2">&quot;pin_memory_device&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin_memory_device</span><span class="p">,</span>
</span><span id="TramDagDataset-477"><a href="#TramDagDataset-477"><span class="linenos">477</span></a>                <span class="p">}</span>
</span><span id="TramDagDataset-478"><a href="#TramDagDataset-478"><span class="linenos">478</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">loaders</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="TramDagDataset-479"><a href="#TramDagDataset-479"><span class="linenos">479</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="TramDagDataset-480"><a href="#TramDagDataset-480"><span class="linenos">480</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">loaders</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span>
</span><span id="TramDagDataset-481"><a href="#TramDagDataset-481"><span class="linenos">481</span></a>                
</span><span id="TramDagDataset-482"><a href="#TramDagDataset-482"><span class="linenos">482</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;use_precomputed&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_precomputed</span><span class="p">:</span>
</span><span id="TramDagDataset-483"><a href="#TramDagDataset-483"><span class="linenos">483</span></a>            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">pth</span><span class="p">):</span>
</span><span id="TramDagDataset-484"><a href="#TramDagDataset-484"><span class="linenos">484</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="TramDagDataset-485"><a href="#TramDagDataset-485"><span class="linenos">485</span></a>                    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">pth</span><span class="p">)</span>
</span><span id="TramDagDataset-486"><a href="#TramDagDataset-486"><span class="linenos">486</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
</span><span id="TramDagDataset-487"><a href="#TramDagDataset-487"><span class="linenos">487</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] Removed existing precomputed file: </span><span class="si">{</span><span class="n">pth</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-488"><a href="#TramDagDataset-488"><span class="linenos">488</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="TramDagDataset-489"><a href="#TramDagDataset-489"><span class="linenos">489</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[WARNING] Could not remove </span><span class="si">{</span><span class="n">pth</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset-490"><a href="#TramDagDataset-490"><span class="linenos">490</span></a>
</span><span id="TramDagDataset-491"><a href="#TramDagDataset-491"><span class="linenos">491</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_check_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_value</span><span class="p">):</span>
</span><span id="TramDagDataset-492"><a href="#TramDagDataset-492"><span class="linenos">492</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TramDagDataset-493"><a href="#TramDagDataset-493"><span class="linenos">493</span></a><span class="sd">        Check that dict-valued attributes use node names as keys.</span>
</span><span id="TramDagDataset-494"><a href="#TramDagDataset-494"><span class="linenos">494</span></a>
</span><span id="TramDagDataset-495"><a href="#TramDagDataset-495"><span class="linenos">495</span></a><span class="sd">        Parameters</span>
</span><span id="TramDagDataset-496"><a href="#TramDagDataset-496"><span class="linenos">496</span></a><span class="sd">        ----------</span>
</span><span id="TramDagDataset-497"><a href="#TramDagDataset-497"><span class="linenos">497</span></a><span class="sd">        attr_name : str</span>
</span><span id="TramDagDataset-498"><a href="#TramDagDataset-498"><span class="linenos">498</span></a><span class="sd">            Name of the attribute being checked (for error messages).</span>
</span><span id="TramDagDataset-499"><a href="#TramDagDataset-499"><span class="linenos">499</span></a><span class="sd">        attr_value : Any</span>
</span><span id="TramDagDataset-500"><a href="#TramDagDataset-500"><span class="linenos">500</span></a><span class="sd">            Attribute value. If it is a dict, its keys are validated.</span>
</span><span id="TramDagDataset-501"><a href="#TramDagDataset-501"><span class="linenos">501</span></a>
</span><span id="TramDagDataset-502"><a href="#TramDagDataset-502"><span class="linenos">502</span></a><span class="sd">        Returns</span>
</span><span id="TramDagDataset-503"><a href="#TramDagDataset-503"><span class="linenos">503</span></a><span class="sd">        -------</span>
</span><span id="TramDagDataset-504"><a href="#TramDagDataset-504"><span class="linenos">504</span></a><span class="sd">        None</span>
</span><span id="TramDagDataset-505"><a href="#TramDagDataset-505"><span class="linenos">505</span></a>
</span><span id="TramDagDataset-506"><a href="#TramDagDataset-506"><span class="linenos">506</span></a><span class="sd">        Raises</span>
</span><span id="TramDagDataset-507"><a href="#TramDagDataset-507"><span class="linenos">507</span></a><span class="sd">        ------</span>
</span><span id="TramDagDataset-508"><a href="#TramDagDataset-508"><span class="linenos">508</span></a><span class="sd">        ValueError</span>
</span><span id="TramDagDataset-509"><a href="#TramDagDataset-509"><span class="linenos">509</span></a><span class="sd">            If `attr_value` is a dict and its keys do not exactly match</span>
</span><span id="TramDagDataset-510"><a href="#TramDagDataset-510"><span class="linenos">510</span></a><span class="sd">            `cfg.conf_dict[&quot;nodes&quot;].keys()`.</span>
</span><span id="TramDagDataset-511"><a href="#TramDagDataset-511"><span class="linenos">511</span></a>
</span><span id="TramDagDataset-512"><a href="#TramDagDataset-512"><span class="linenos">512</span></a><span class="sd">        Notes</span>
</span><span id="TramDagDataset-513"><a href="#TramDagDataset-513"><span class="linenos">513</span></a><span class="sd">        -----</span>
</span><span id="TramDagDataset-514"><a href="#TramDagDataset-514"><span class="linenos">514</span></a><span class="sd">        This check prevents partial or mismatched per-node settings such as</span>
</span><span id="TramDagDataset-515"><a href="#TramDagDataset-515"><span class="linenos">515</span></a><span class="sd">        batch sizes or shuffle flags.</span>
</span><span id="TramDagDataset-516"><a href="#TramDagDataset-516"><span class="linenos">516</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TramDagDataset-517"><a href="#TramDagDataset-517"><span class="linenos">517</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attr_value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="TramDagDataset-518"><a href="#TramDagDataset-518"><span class="linenos">518</span></a>            <span class="n">expected_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="TramDagDataset-519"><a href="#TramDagDataset-519"><span class="linenos">519</span></a>            <span class="n">given_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">attr_value</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="TramDagDataset-520"><a href="#TramDagDataset-520"><span class="linenos">520</span></a>            <span class="k">if</span> <span class="n">expected_keys</span> <span class="o">!=</span> <span class="n">given_keys</span><span class="p">:</span>
</span><span id="TramDagDataset-521"><a href="#TramDagDataset-521"><span class="linenos">521</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="TramDagDataset-522"><a href="#TramDagDataset-522"><span class="linenos">522</span></a>                    <span class="sa">f</span><span class="s2">&quot;[ERROR] the provided attribute &#39;</span><span class="si">{</span><span class="n">attr_name</span><span class="si">}</span><span class="s2">&#39; keys are not same as in cfg.conf_dict[&#39;nodes&#39;].keys().</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="TramDagDataset-523"><a href="#TramDagDataset-523"><span class="linenos">523</span></a>                    <span class="sa">f</span><span class="s2">&quot;Expected: </span><span class="si">{</span><span class="n">expected_keys</span><span class="si">}</span><span class="s2">, but got: </span><span class="si">{</span><span class="n">given_keys</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="TramDagDataset-524"><a href="#TramDagDataset-524"><span class="linenos">524</span></a>                    <span class="sa">f</span><span class="s2">&quot;Please provide values for all variables.&quot;</span>
</span><span id="TramDagDataset-525"><a href="#TramDagDataset-525"><span class="linenos">525</span></a>                <span class="p">)</span>
</span><span id="TramDagDataset-526"><a href="#TramDagDataset-526"><span class="linenos">526</span></a>
</span><span id="TramDagDataset-527"><a href="#TramDagDataset-527"><span class="linenos">527</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
</span><span id="TramDagDataset-528"><a href="#TramDagDataset-528"><span class="linenos">528</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
</span><span id="TramDagDataset-529"><a href="#TramDagDataset-529"><span class="linenos">529</span></a>
</span><span id="TramDagDataset-530"><a href="#TramDagDataset-530"><span class="linenos">530</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TramDagDataset-531"><a href="#TramDagDataset-531"><span class="linenos">531</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h1 id="tramdagdataset">TramDagDataset</h1>

<p>The <code><a href="#TramDagDataset">TramDagDataset</a></code> class handles structured data preparation for TRAM-DAG
models. It wraps a pandas DataFrame together with its configuration and provides
utilities for scaling, transformation, and efficient DataLoader construction
for each node in a DAG-based configuration.</p>

<hr />

<h2 id="core-responsibilities">Core Responsibilities</h2>

<ul>
<li>Validate and store configuration metadata (<code>TramDagConfig</code>).</li>
<li>Manage per-node settings for DataLoader creation (batch size, shuffling, workers).</li>
<li>Compute scaling information (quantile-based min/max).</li>
<li>Optionally precompute and cache dataset representations.</li>
<li>Expose PyTorch Dataset and DataLoader interfaces for model training.</li>
</ul>

<hr />

<h2 id="key-attributes">Key Attributes</h2>

<ul>
<li><p><strong>df</strong> : pandas.DataFrame<br />
The dataset content used for building loaders and computing scaling.</p></li>
<li><p><strong>cfg</strong> : TramDagConfig<br />
Configuration object defining nodes and variable metadata.</p></li>
<li><p><strong>nodes_dict</strong> : dict<br />
Mapping of variable names to node specifications from the configuration.</p></li>
<li><p><strong>loaders</strong> : dict<br />
Mapping of node names to <code>torch.utils.data.DataLoader</code> instances or <code>GenericDataset</code> objects.</p></li>
<li><p><strong>DEFAULTS</strong> : dict<br />
Default DataLoader and dataset-related settings (e.g., batch_size, shuffle, num_workers, etc.).</p></li>
</ul>

<hr />

<h2 id="main-methods">Main Methods</h2>

<ul>
<li><p><strong>from_dataframe(df, cfg, **kwargs)</strong><br />
Construct the dataset directly from a pandas DataFrame.</p></li>
<li><p><strong>compute_scaling(df=None, write=True)</strong><br />
Compute per-variable min/max scaling values from data.</p></li>
<li><p><strong>summary()</strong><br />
Print dataset overview including shape, dtypes, statistics, and node settings.</p></li>
</ul>

<hr />

<h2 id="notes">Notes</h2>

<ul>
<li>Intended for training data; <code><a href="#TramDagDataset.compute_scaling">compute_scaling()</a></code> should use only training subsets.</li>
<li>Compatible with both CPU and GPU DataLoader options.</li>
<li>Strict validation of keyword arguments against <code><a href="#TramDagDataset.DEFAULTS">DEFAULTS</a></code> prevents silent misconfiguration.</li>
</ul>

<hr />

<h2 id="example">Example</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="n">TramDagConfig</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="s2">&quot;config.json&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n"><a href="#TramDagDataset.from_dataframe">TramDagDataset.from_dataframe</a></span><span class="p">(</span><span class="n">train_df</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">minmax</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">compute_scaling</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">loaders</span><span class="p">[</span><span class="s2">&quot;variable_x&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">loader</span><span class="p">))</span>
</code></pre>
</div>
</div>


                            <div id="TramDagDataset.__init__" class="classattr">
                                        <input id="TramDagDataset.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">TramDagDataset</span><span class="signature pdoc-code condensed">()</span>

                <label class="view-source-button" for="TramDagDataset.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TramDagDataset.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TramDagDataset.__init__-121"><a href="#TramDagDataset.__init__-121"><span class="linenos">121</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TramDagDataset.__init__-122"><a href="#TramDagDataset.__init__-122"><span class="linenos">122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TramDagDataset.__init__-123"><a href="#TramDagDataset.__init__-123"><span class="linenos">123</span></a><span class="sd">        Initialize an empty TramDagDataset shell.</span>
</span><span id="TramDagDataset.__init__-124"><a href="#TramDagDataset.__init__-124"><span class="linenos">124</span></a>
</span><span id="TramDagDataset.__init__-125"><a href="#TramDagDataset.__init__-125"><span class="linenos">125</span></a><span class="sd">        Notes</span>
</span><span id="TramDagDataset.__init__-126"><a href="#TramDagDataset.__init__-126"><span class="linenos">126</span></a><span class="sd">        -----</span>
</span><span id="TramDagDataset.__init__-127"><a href="#TramDagDataset.__init__-127"><span class="linenos">127</span></a><span class="sd">        This constructor does not attach data or configuration. Use</span>
</span><span id="TramDagDataset.__init__-128"><a href="#TramDagDataset.__init__-128"><span class="linenos">128</span></a><span class="sd">        `TramDagDataset.from_dataframe` to obtain a ready-to-use instance.</span>
</span><span id="TramDagDataset.__init__-129"><a href="#TramDagDataset.__init__-129"><span class="linenos">129</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TramDagDataset.__init__-130"><a href="#TramDagDataset.__init__-130"><span class="linenos">130</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Initialize an empty TramDagDataset shell.</p>

<h2 id="notes">Notes</h2>

<p>This constructor does not attach data or configuration. Use
<code><a href="#TramDagDataset.from_dataframe">TramDagDataset.from_dataframe</a></code> to obtain a ready-to-use instance.</p>
</div>


                            </div>
                            <div id="TramDagDataset.DEFAULTS" class="classattr">
                                <div class="attr variable">
            <span class="name">DEFAULTS</span>        =
<input id="TramDagDataset.DEFAULTS-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="TramDagDataset.DEFAULTS-view-value"></label><span class="default_value">{&#39;batch_size&#39;: 32000, &#39;shuffle&#39;: True, &#39;num_workers&#39;: 4, &#39;pin_memory&#39;: True, &#39;return_intercept_shift&#39;: True, &#39;debug&#39;: False, &#39;transform&#39;: None, &#39;use_dataloader&#39;: True, &#39;use_precomputed&#39;: False, &#39;sampler&#39;: None, &#39;batch_sampler&#39;: None, &#39;collate_fn&#39;: None, &#39;drop_last&#39;: False, &#39;timeout&#39;: 0, &#39;worker_init_fn&#39;: None, &#39;multiprocessing_context&#39;: None, &#39;generator&#39;: None, &#39;prefetch_factor&#39;: 2, &#39;persistent_workers&#39;: True, &#39;pin_memory_device&#39;: &#39;&#39;}</span>

        
    </div>
    <a class="headerlink" href="#TramDagDataset.DEFAULTS"></a>
    
    

                            </div>
                            <div id="TramDagDataset.from_dataframe" class="classattr">
                                        <input id="TramDagDataset.from_dataframe-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_dataframe</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">df</span>, </span><span class="param"><span class="n">cfg</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TramDagDataset.from_dataframe-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TramDagDataset.from_dataframe"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TramDagDataset.from_dataframe-132"><a href="#TramDagDataset.from_dataframe-132"><span class="linenos">132</span></a>    <span class="nd">@classmethod</span>
</span><span id="TramDagDataset.from_dataframe-133"><a href="#TramDagDataset.from_dataframe-133"><span class="linenos">133</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_dataframe</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="TramDagDataset.from_dataframe-134"><a href="#TramDagDataset.from_dataframe-134"><span class="linenos">134</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TramDagDataset.from_dataframe-135"><a href="#TramDagDataset.from_dataframe-135"><span class="linenos">135</span></a><span class="sd">        Create a TramDagDataset instance directly from a pandas DataFrame.</span>
</span><span id="TramDagDataset.from_dataframe-136"><a href="#TramDagDataset.from_dataframe-136"><span class="linenos">136</span></a>
</span><span id="TramDagDataset.from_dataframe-137"><a href="#TramDagDataset.from_dataframe-137"><span class="linenos">137</span></a><span class="sd">        This classmethod:</span>
</span><span id="TramDagDataset.from_dataframe-138"><a href="#TramDagDataset.from_dataframe-138"><span class="linenos">138</span></a>
</span><span id="TramDagDataset.from_dataframe-139"><a href="#TramDagDataset.from_dataframe-139"><span class="linenos">139</span></a><span class="sd">        1. Validates keyword arguments against `DEFAULTS`.</span>
</span><span id="TramDagDataset.from_dataframe-140"><a href="#TramDagDataset.from_dataframe-140"><span class="linenos">140</span></a><span class="sd">        2. Merges user overrides with defaults into a resolved settings dict.</span>
</span><span id="TramDagDataset.from_dataframe-141"><a href="#TramDagDataset.from_dataframe-141"><span class="linenos">141</span></a><span class="sd">        3. Stores the configuration and verifies its completeness.</span>
</span><span id="TramDagDataset.from_dataframe-142"><a href="#TramDagDataset.from_dataframe-142"><span class="linenos">142</span></a><span class="sd">        4. Applies settings to the instance.</span>
</span><span id="TramDagDataset.from_dataframe-143"><a href="#TramDagDataset.from_dataframe-143"><span class="linenos">143</span></a><span class="sd">        5. Builds per-node datasets and DataLoaders.</span>
</span><span id="TramDagDataset.from_dataframe-144"><a href="#TramDagDataset.from_dataframe-144"><span class="linenos">144</span></a>
</span><span id="TramDagDataset.from_dataframe-145"><a href="#TramDagDataset.from_dataframe-145"><span class="linenos">145</span></a><span class="sd">        Parameters</span>
</span><span id="TramDagDataset.from_dataframe-146"><a href="#TramDagDataset.from_dataframe-146"><span class="linenos">146</span></a><span class="sd">        ----------</span>
</span><span id="TramDagDataset.from_dataframe-147"><a href="#TramDagDataset.from_dataframe-147"><span class="linenos">147</span></a><span class="sd">        df : pandas.DataFrame</span>
</span><span id="TramDagDataset.from_dataframe-148"><a href="#TramDagDataset.from_dataframe-148"><span class="linenos">148</span></a><span class="sd">            Input DataFrame containing the dataset.</span>
</span><span id="TramDagDataset.from_dataframe-149"><a href="#TramDagDataset.from_dataframe-149"><span class="linenos">149</span></a><span class="sd">        cfg : TramDagConfig</span>
</span><span id="TramDagDataset.from_dataframe-150"><a href="#TramDagDataset.from_dataframe-150"><span class="linenos">150</span></a><span class="sd">            Configuration object defining nodes and variable metadata.</span>
</span><span id="TramDagDataset.from_dataframe-151"><a href="#TramDagDataset.from_dataframe-151"><span class="linenos">151</span></a><span class="sd">        **kwargs</span>
</span><span id="TramDagDataset.from_dataframe-152"><a href="#TramDagDataset.from_dataframe-152"><span class="linenos">152</span></a><span class="sd">            Optional overrides for `DEFAULTS`. All keys must exist in</span>
</span><span id="TramDagDataset.from_dataframe-153"><a href="#TramDagDataset.from_dataframe-153"><span class="linenos">153</span></a><span class="sd">            `TramDagDataset.DEFAULTS`. Common keys include:</span>
</span><span id="TramDagDataset.from_dataframe-154"><a href="#TramDagDataset.from_dataframe-154"><span class="linenos">154</span></a>
</span><span id="TramDagDataset.from_dataframe-155"><a href="#TramDagDataset.from_dataframe-155"><span class="linenos">155</span></a><span class="sd">            batch_size : int</span>
</span><span id="TramDagDataset.from_dataframe-156"><a href="#TramDagDataset.from_dataframe-156"><span class="linenos">156</span></a><span class="sd">                Batch size for DataLoaders.</span>
</span><span id="TramDagDataset.from_dataframe-157"><a href="#TramDagDataset.from_dataframe-157"><span class="linenos">157</span></a><span class="sd">            shuffle : bool</span>
</span><span id="TramDagDataset.from_dataframe-158"><a href="#TramDagDataset.from_dataframe-158"><span class="linenos">158</span></a><span class="sd">                Whether to shuffle samples per epoch.</span>
</span><span id="TramDagDataset.from_dataframe-159"><a href="#TramDagDataset.from_dataframe-159"><span class="linenos">159</span></a><span class="sd">            num_workers : int</span>
</span><span id="TramDagDataset.from_dataframe-160"><a href="#TramDagDataset.from_dataframe-160"><span class="linenos">160</span></a><span class="sd">                Number of DataLoader workers.</span>
</span><span id="TramDagDataset.from_dataframe-161"><a href="#TramDagDataset.from_dataframe-161"><span class="linenos">161</span></a><span class="sd">            pin_memory : bool</span>
</span><span id="TramDagDataset.from_dataframe-162"><a href="#TramDagDataset.from_dataframe-162"><span class="linenos">162</span></a><span class="sd">                Whether to pin memory for faster host-to-device transfers.</span>
</span><span id="TramDagDataset.from_dataframe-163"><a href="#TramDagDataset.from_dataframe-163"><span class="linenos">163</span></a><span class="sd">            return_intercept_shift : bool</span>
</span><span id="TramDagDataset.from_dataframe-164"><a href="#TramDagDataset.from_dataframe-164"><span class="linenos">164</span></a><span class="sd">                Whether datasets should return intercept/shift information.</span>
</span><span id="TramDagDataset.from_dataframe-165"><a href="#TramDagDataset.from_dataframe-165"><span class="linenos">165</span></a><span class="sd">            debug : bool</span>
</span><span id="TramDagDataset.from_dataframe-166"><a href="#TramDagDataset.from_dataframe-166"><span class="linenos">166</span></a><span class="sd">                Enable debug printing.</span>
</span><span id="TramDagDataset.from_dataframe-167"><a href="#TramDagDataset.from_dataframe-167"><span class="linenos">167</span></a><span class="sd">            transform : callable or dict or None</span>
</span><span id="TramDagDataset.from_dataframe-168"><a href="#TramDagDataset.from_dataframe-168"><span class="linenos">168</span></a><span class="sd">                Optional transform(s) applied to samples.</span>
</span><span id="TramDagDataset.from_dataframe-169"><a href="#TramDagDataset.from_dataframe-169"><span class="linenos">169</span></a><span class="sd">            use_dataloader : bool</span>
</span><span id="TramDagDataset.from_dataframe-170"><a href="#TramDagDataset.from_dataframe-170"><span class="linenos">170</span></a><span class="sd">                If True, construct DataLoaders; else store raw Dataset objects.</span>
</span><span id="TramDagDataset.from_dataframe-171"><a href="#TramDagDataset.from_dataframe-171"><span class="linenos">171</span></a><span class="sd">            use_precomputed : bool</span>
</span><span id="TramDagDataset.from_dataframe-172"><a href="#TramDagDataset.from_dataframe-172"><span class="linenos">172</span></a><span class="sd">                If True, precompute dataset representation to disk and reload it.</span>
</span><span id="TramDagDataset.from_dataframe-173"><a href="#TramDagDataset.from_dataframe-173"><span class="linenos">173</span></a>
</span><span id="TramDagDataset.from_dataframe-174"><a href="#TramDagDataset.from_dataframe-174"><span class="linenos">174</span></a><span class="sd">        Returns</span>
</span><span id="TramDagDataset.from_dataframe-175"><a href="#TramDagDataset.from_dataframe-175"><span class="linenos">175</span></a><span class="sd">        -------</span>
</span><span id="TramDagDataset.from_dataframe-176"><a href="#TramDagDataset.from_dataframe-176"><span class="linenos">176</span></a><span class="sd">        TramDagDataset</span>
</span><span id="TramDagDataset.from_dataframe-177"><a href="#TramDagDataset.from_dataframe-177"><span class="linenos">177</span></a><span class="sd">            Initialized dataset instance.</span>
</span><span id="TramDagDataset.from_dataframe-178"><a href="#TramDagDataset.from_dataframe-178"><span class="linenos">178</span></a>
</span><span id="TramDagDataset.from_dataframe-179"><a href="#TramDagDataset.from_dataframe-179"><span class="linenos">179</span></a><span class="sd">        Raises</span>
</span><span id="TramDagDataset.from_dataframe-180"><a href="#TramDagDataset.from_dataframe-180"><span class="linenos">180</span></a><span class="sd">        ------</span>
</span><span id="TramDagDataset.from_dataframe-181"><a href="#TramDagDataset.from_dataframe-181"><span class="linenos">181</span></a><span class="sd">        TypeError</span>
</span><span id="TramDagDataset.from_dataframe-182"><a href="#TramDagDataset.from_dataframe-182"><span class="linenos">182</span></a><span class="sd">            If `df` is not a pandas DataFrame.</span>
</span><span id="TramDagDataset.from_dataframe-183"><a href="#TramDagDataset.from_dataframe-183"><span class="linenos">183</span></a><span class="sd">        ValueError</span>
</span><span id="TramDagDataset.from_dataframe-184"><a href="#TramDagDataset.from_dataframe-184"><span class="linenos">184</span></a><span class="sd">            If unknown keyword arguments are provided (when validation is enabled).</span>
</span><span id="TramDagDataset.from_dataframe-185"><a href="#TramDagDataset.from_dataframe-185"><span class="linenos">185</span></a>
</span><span id="TramDagDataset.from_dataframe-186"><a href="#TramDagDataset.from_dataframe-186"><span class="linenos">186</span></a><span class="sd">        Notes</span>
</span><span id="TramDagDataset.from_dataframe-187"><a href="#TramDagDataset.from_dataframe-187"><span class="linenos">187</span></a><span class="sd">        -----</span>
</span><span id="TramDagDataset.from_dataframe-188"><a href="#TramDagDataset.from_dataframe-188"><span class="linenos">188</span></a><span class="sd">        If `shuffle=True` and the inferred variable name of `df` suggests</span>
</span><span id="TramDagDataset.from_dataframe-189"><a href="#TramDagDataset.from_dataframe-189"><span class="linenos">189</span></a><span class="sd">        validation/test data (e.g. &quot;val&quot;, &quot;test&quot;), a warning is printed.</span>
</span><span id="TramDagDataset.from_dataframe-190"><a href="#TramDagDataset.from_dataframe-190"><span class="linenos">190</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TramDagDataset.from_dataframe-191"><a href="#TramDagDataset.from_dataframe-191"><span class="linenos">191</span></a>        <span class="bp">self</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
</span><span id="TramDagDataset.from_dataframe-192"><a href="#TramDagDataset.from_dataframe-192"><span class="linenos">192</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="TramDagDataset.from_dataframe-193"><a href="#TramDagDataset.from_dataframe-193"><span class="linenos">193</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[ERROR] df must be a pandas DataFrame, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset.from_dataframe-194"><a href="#TramDagDataset.from_dataframe-194"><span class="linenos">194</span></a>
</span><span id="TramDagDataset.from_dataframe-195"><a href="#TramDagDataset.from_dataframe-195"><span class="linenos">195</span></a>        <span class="c1"># validate kwargs</span>
</span><span id="TramDagDataset.from_dataframe-196"><a href="#TramDagDataset.from_dataframe-196"><span class="linenos">196</span></a>        <span class="c1"># TODO adjust validation such thath it works when called from tramdagmodel</span>
</span><span id="TramDagDataset.from_dataframe-197"><a href="#TramDagDataset.from_dataframe-197"><span class="linenos">197</span></a>        <span class="c1">#self._validate_kwargs(kwargs, context=&quot;from_dataframe&quot;)</span>
</span><span id="TramDagDataset.from_dataframe-198"><a href="#TramDagDataset.from_dataframe-198"><span class="linenos">198</span></a>        
</span><span id="TramDagDataset.from_dataframe-199"><a href="#TramDagDataset.from_dataframe-199"><span class="linenos">199</span></a>        <span class="c1"># merge defaults with overrides</span>
</span><span id="TramDagDataset.from_dataframe-200"><a href="#TramDagDataset.from_dataframe-200"><span class="linenos">200</span></a>        <span class="n">settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">DEFAULTS</span><span class="p">)</span>
</span><span id="TramDagDataset.from_dataframe-201"><a href="#TramDagDataset.from_dataframe-201"><span class="linenos">201</span></a>        <span class="n">settings</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="TramDagDataset.from_dataframe-202"><a href="#TramDagDataset.from_dataframe-202"><span class="linenos">202</span></a>
</span><span id="TramDagDataset.from_dataframe-203"><a href="#TramDagDataset.from_dataframe-203"><span class="linenos">203</span></a>        <span class="c1"># store config and verify</span>
</span><span id="TramDagDataset.from_dataframe-204"><a href="#TramDagDataset.from_dataframe-204"><span class="linenos">204</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span> <span class="o">=</span> <span class="n">cfg</span>
</span><span id="TramDagDataset.from_dataframe-205"><a href="#TramDagDataset.from_dataframe-205"><span class="linenos">205</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">_verify_completeness</span><span class="p">()</span>
</span><span id="TramDagDataset.from_dataframe-206"><a href="#TramDagDataset.from_dataframe-206"><span class="linenos">206</span></a>
</span><span id="TramDagDataset.from_dataframe-207"><a href="#TramDagDataset.from_dataframe-207"><span class="linenos">207</span></a>        <span class="c1"># ouptu all setttings if debug</span>
</span><span id="TramDagDataset.from_dataframe-208"><a href="#TramDagDataset.from_dataframe-208"><span class="linenos">208</span></a>        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="TramDagDataset.from_dataframe-209"><a href="#TramDagDataset.from_dataframe-209"><span class="linenos">209</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[DEBUG] TramDagDataset.from_dataframe() settings (after defaults + overrides):&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset.from_dataframe-210"><a href="#TramDagDataset.from_dataframe-210"><span class="linenos">210</span></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="TramDagDataset.from_dataframe-211"><a href="#TramDagDataset.from_dataframe-211"><span class="linenos">211</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset.from_dataframe-212"><a href="#TramDagDataset.from_dataframe-212"><span class="linenos">212</span></a>
</span><span id="TramDagDataset.from_dataframe-213"><a href="#TramDagDataset.from_dataframe-213"><span class="linenos">213</span></a>        <span class="c1"># infer variable name automatically</span>
</span><span id="TramDagDataset.from_dataframe-214"><a href="#TramDagDataset.from_dataframe-214"><span class="linenos">214</span></a>        <span class="n">callers_locals</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_back</span><span class="o">.</span><span class="n">f_locals</span>
</span><span id="TramDagDataset.from_dataframe-215"><a href="#TramDagDataset.from_dataframe-215"><span class="linenos">215</span></a>        <span class="n">inferred</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="TramDagDataset.from_dataframe-216"><a href="#TramDagDataset.from_dataframe-216"><span class="linenos">216</span></a>        <span class="k">for</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">var_val</span> <span class="ow">in</span> <span class="n">callers_locals</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="TramDagDataset.from_dataframe-217"><a href="#TramDagDataset.from_dataframe-217"><span class="linenos">217</span></a>            <span class="k">if</span> <span class="n">var_val</span> <span class="ow">is</span> <span class="n">df</span><span class="p">:</span>
</span><span id="TramDagDataset.from_dataframe-218"><a href="#TramDagDataset.from_dataframe-218"><span class="linenos">218</span></a>                <span class="n">inferred</span> <span class="o">=</span> <span class="n">var_name</span>
</span><span id="TramDagDataset.from_dataframe-219"><a href="#TramDagDataset.from_dataframe-219"><span class="linenos">219</span></a>                <span class="k">break</span>
</span><span id="TramDagDataset.from_dataframe-220"><a href="#TramDagDataset.from_dataframe-220"><span class="linenos">220</span></a>        <span class="n">df_name</span> <span class="o">=</span> <span class="n">inferred</span> <span class="ow">or</span> <span class="s2">&quot;dataframe&quot;</span>
</span><span id="TramDagDataset.from_dataframe-221"><a href="#TramDagDataset.from_dataframe-221"><span class="linenos">221</span></a>
</span><span id="TramDagDataset.from_dataframe-222"><a href="#TramDagDataset.from_dataframe-222"><span class="linenos">222</span></a>        <span class="k">if</span> <span class="n">settings</span><span class="p">[</span><span class="s2">&quot;shuffle&quot;</span><span class="p">]:</span>
</span><span id="TramDagDataset.from_dataframe-223"><a href="#TramDagDataset.from_dataframe-223"><span class="linenos">223</span></a>            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">df_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;val&quot;</span><span class="p">,</span> <span class="s2">&quot;validation&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">]):</span>
</span><span id="TramDagDataset.from_dataframe-224"><a href="#TramDagDataset.from_dataframe-224"><span class="linenos">224</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[WARNING] DataFrame &#39;</span><span class="si">{</span><span class="n">df_name</span><span class="si">}</span><span class="s2">&#39; looks like a validation/test set  shuffle=True. Are you sure?&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset.from_dataframe-225"><a href="#TramDagDataset.from_dataframe-225"><span class="linenos">225</span></a>
</span><span id="TramDagDataset.from_dataframe-226"><a href="#TramDagDataset.from_dataframe-226"><span class="linenos">226</span></a>        <span class="c1"># call again to ensure Warning messages if ordinal vars have missing levels</span>
</span><span id="TramDagDataset.from_dataframe-227"><a href="#TramDagDataset.from_dataframe-227"><span class="linenos">227</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="TramDagDataset.from_dataframe-228"><a href="#TramDagDataset.from_dataframe-228"><span class="linenos">228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_settings</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
</span><span id="TramDagDataset.from_dataframe-229"><a href="#TramDagDataset.from_dataframe-229"><span class="linenos">229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_build_dataloaders</span><span class="p">()</span>
</span><span id="TramDagDataset.from_dataframe-230"><a href="#TramDagDataset.from_dataframe-230"><span class="linenos">230</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Create a TramDagDataset instance directly from a pandas DataFrame.</p>

<p>This classmethod:</p>

<ol>
<li>Validates keyword arguments against <code><a href="#TramDagDataset.DEFAULTS">DEFAULTS</a></code>.</li>
<li>Merges user overrides with defaults into a resolved settings dict.</li>
<li>Stores the configuration and verifies its completeness.</li>
<li>Applies settings to the instance.</li>
<li>Builds per-node datasets and DataLoaders.</li>
</ol>

<h2 id="parameters">Parameters</h2>

<p>df : pandas.DataFrame
    Input DataFrame containing the dataset.
cfg : TramDagConfig
    Configuration object defining nodes and variable metadata.
**kwargs
    Optional overrides for <code><a href="#TramDagDataset.DEFAULTS">DEFAULTS</a></code>. All keys must exist in
    <code><a href="#TramDagDataset.DEFAULTS">TramDagDataset.DEFAULTS</a></code>. Common keys include:</p>

<pre><code>batch_size : int
    Batch size for DataLoaders.
shuffle : bool
    Whether to shuffle samples per epoch.
num_workers : int
    Number of DataLoader workers.
pin_memory : bool
    Whether to pin memory for faster host-to-device transfers.
return_intercept_shift : bool
    Whether datasets should return intercept/shift information.
debug : bool
    Enable debug printing.
transform : callable or dict or None
    Optional transform(s) applied to samples.
use_dataloader : bool
    If True, construct DataLoaders; else store raw Dataset objects.
use_precomputed : bool
    If True, precompute dataset representation to disk and reload it.
</code></pre>

<h2 id="returns">Returns</h2>

<p>TramDagDataset
    Initialized dataset instance.</p>

<h2 id="raises">Raises</h2>

<p>TypeError
    If <code>df</code> is not a pandas DataFrame.
ValueError
    If unknown keyword arguments are provided (when validation is enabled).</p>

<h2 id="notes">Notes</h2>

<p>If <code>shuffle=True</code> and the inferred variable name of <code>df</code> suggests
validation/test data (e.g. "val", "test"), a warning is printed.</p>
</div>


                            </div>
                            <div id="TramDagDataset.compute_scaling" class="classattr">
                                        <input id="TramDagDataset.compute_scaling-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">compute_scaling</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">df</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">write</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TramDagDataset.compute_scaling-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TramDagDataset.compute_scaling"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TramDagDataset.compute_scaling-232"><a href="#TramDagDataset.compute_scaling-232"><span class="linenos">232</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">compute_scaling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">write</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="TramDagDataset.compute_scaling-233"><a href="#TramDagDataset.compute_scaling-233"><span class="linenos">233</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TramDagDataset.compute_scaling-234"><a href="#TramDagDataset.compute_scaling-234"><span class="linenos">234</span></a><span class="sd">        Compute variable-wise scaling parameters from data.</span>
</span><span id="TramDagDataset.compute_scaling-235"><a href="#TramDagDataset.compute_scaling-235"><span class="linenos">235</span></a>
</span><span id="TramDagDataset.compute_scaling-236"><a href="#TramDagDataset.compute_scaling-236"><span class="linenos">236</span></a><span class="sd">        Per variable, this method computes approximate minimum and maximum</span>
</span><span id="TramDagDataset.compute_scaling-237"><a href="#TramDagDataset.compute_scaling-237"><span class="linenos">237</span></a><span class="sd">        values using the 5th and 95th percentiles. This is typically used</span>
</span><span id="TramDagDataset.compute_scaling-238"><a href="#TramDagDataset.compute_scaling-238"><span class="linenos">238</span></a><span class="sd">        to derive robust normalization/clipping ranges from training data.</span>
</span><span id="TramDagDataset.compute_scaling-239"><a href="#TramDagDataset.compute_scaling-239"><span class="linenos">239</span></a>
</span><span id="TramDagDataset.compute_scaling-240"><a href="#TramDagDataset.compute_scaling-240"><span class="linenos">240</span></a><span class="sd">        Parameters</span>
</span><span id="TramDagDataset.compute_scaling-241"><a href="#TramDagDataset.compute_scaling-241"><span class="linenos">241</span></a><span class="sd">        ----------</span>
</span><span id="TramDagDataset.compute_scaling-242"><a href="#TramDagDataset.compute_scaling-242"><span class="linenos">242</span></a><span class="sd">        df : pandas.DataFrame or None, optional</span>
</span><span id="TramDagDataset.compute_scaling-243"><a href="#TramDagDataset.compute_scaling-243"><span class="linenos">243</span></a><span class="sd">            DataFrame used to compute scaling. If None, `self.df` is used.</span>
</span><span id="TramDagDataset.compute_scaling-244"><a href="#TramDagDataset.compute_scaling-244"><span class="linenos">244</span></a><span class="sd">        write : bool, optional</span>
</span><span id="TramDagDataset.compute_scaling-245"><a href="#TramDagDataset.compute_scaling-245"><span class="linenos">245</span></a><span class="sd">            Unused placeholder for interface compatibility with other components.</span>
</span><span id="TramDagDataset.compute_scaling-246"><a href="#TramDagDataset.compute_scaling-246"><span class="linenos">246</span></a><span class="sd">            Kept for potential future extensions. Default is True.</span>
</span><span id="TramDagDataset.compute_scaling-247"><a href="#TramDagDataset.compute_scaling-247"><span class="linenos">247</span></a>
</span><span id="TramDagDataset.compute_scaling-248"><a href="#TramDagDataset.compute_scaling-248"><span class="linenos">248</span></a><span class="sd">        Returns</span>
</span><span id="TramDagDataset.compute_scaling-249"><a href="#TramDagDataset.compute_scaling-249"><span class="linenos">249</span></a><span class="sd">        -------</span>
</span><span id="TramDagDataset.compute_scaling-250"><a href="#TramDagDataset.compute_scaling-250"><span class="linenos">250</span></a><span class="sd">        dict</span>
</span><span id="TramDagDataset.compute_scaling-251"><a href="#TramDagDataset.compute_scaling-251"><span class="linenos">251</span></a><span class="sd">            Mapping `{column_name: [min_value, max_value]}`, where values</span>
</span><span id="TramDagDataset.compute_scaling-252"><a href="#TramDagDataset.compute_scaling-252"><span class="linenos">252</span></a><span class="sd">            are derived from the 0.05 and 0.95 quantiles.</span>
</span><span id="TramDagDataset.compute_scaling-253"><a href="#TramDagDataset.compute_scaling-253"><span class="linenos">253</span></a>
</span><span id="TramDagDataset.compute_scaling-254"><a href="#TramDagDataset.compute_scaling-254"><span class="linenos">254</span></a><span class="sd">        Notes</span>
</span><span id="TramDagDataset.compute_scaling-255"><a href="#TramDagDataset.compute_scaling-255"><span class="linenos">255</span></a><span class="sd">        -----</span>
</span><span id="TramDagDataset.compute_scaling-256"><a href="#TramDagDataset.compute_scaling-256"><span class="linenos">256</span></a><span class="sd">        If `self.debug` is True, the method emits debug messages about the</span>
</span><span id="TramDagDataset.compute_scaling-257"><a href="#TramDagDataset.compute_scaling-257"><span class="linenos">257</span></a><span class="sd">        data source. Only training data should be used to avoid leakage.</span>
</span><span id="TramDagDataset.compute_scaling-258"><a href="#TramDagDataset.compute_scaling-258"><span class="linenos">258</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TramDagDataset.compute_scaling-259"><a href="#TramDagDataset.compute_scaling-259"><span class="linenos">259</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
</span><span id="TramDagDataset.compute_scaling-260"><a href="#TramDagDataset.compute_scaling-260"><span class="linenos">260</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[DEBUG] Make sure to provide only training data to compute_scaling!&quot;</span><span class="p">)</span>     
</span><span id="TramDagDataset.compute_scaling-261"><a href="#TramDagDataset.compute_scaling-261"><span class="linenos">261</span></a>        <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TramDagDataset.compute_scaling-262"><a href="#TramDagDataset.compute_scaling-262"><span class="linenos">262</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span>
</span><span id="TramDagDataset.compute_scaling-263"><a href="#TramDagDataset.compute_scaling-263"><span class="linenos">263</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
</span><span id="TramDagDataset.compute_scaling-264"><a href="#TramDagDataset.compute_scaling-264"><span class="linenos">264</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[DEBUG] No DataFrame provided, using internal df.&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset.compute_scaling-265"><a href="#TramDagDataset.compute_scaling-265"><span class="linenos">265</span></a>        <span class="n">quantiles</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
</span><span id="TramDagDataset.compute_scaling-266"><a href="#TramDagDataset.compute_scaling-266"><span class="linenos">266</span></a>        <span class="n">min_vals</span> <span class="o">=</span> <span class="n">quantiles</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">0.05</span><span class="p">]</span>
</span><span id="TramDagDataset.compute_scaling-267"><a href="#TramDagDataset.compute_scaling-267"><span class="linenos">267</span></a>        <span class="n">max_vals</span> <span class="o">=</span> <span class="n">quantiles</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">0.95</span><span class="p">]</span>
</span><span id="TramDagDataset.compute_scaling-268"><a href="#TramDagDataset.compute_scaling-268"><span class="linenos">268</span></a>        <span class="n">minmax_dict</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">min_vals</span><span class="p">,</span> <span class="n">max_vals</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>
</span><span id="TramDagDataset.compute_scaling-269"><a href="#TramDagDataset.compute_scaling-269"><span class="linenos">269</span></a>        <span class="k">return</span> <span class="n">minmax_dict</span>
</span></pre></div>


            <div class="docstring"><p>Compute variable-wise scaling parameters from data.</p>

<p>Per variable, this method computes approximate minimum and maximum
values using the 5th and 95th percentiles. This is typically used
to derive robust normalization/clipping ranges from training data.</p>

<h2 id="parameters">Parameters</h2>

<p>df : pandas.DataFrame or None, optional
    DataFrame used to compute scaling. If None, <code>self.df</code> is used.
write : bool, optional
    Unused placeholder for interface compatibility with other components.
    Kept for potential future extensions. Default is True.</p>

<h2 id="returns">Returns</h2>

<p>dict
    Mapping <code>{column_name: [min_value, max_value]}</code>, where values
    are derived from the 0.05 and 0.95 quantiles.</p>

<h2 id="notes">Notes</h2>

<p>If <code>self.debug</code> is True, the method emits debug messages about the
data source. Only training data should be used to avoid leakage.</p>
</div>


                            </div>
                            <div id="TramDagDataset.summary" class="classattr">
                                        <input id="TramDagDataset.summary-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">summary</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TramDagDataset.summary-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TramDagDataset.summary"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TramDagDataset.summary-271"><a href="#TramDagDataset.summary-271"><span class="linenos">271</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TramDagDataset.summary-272"><a href="#TramDagDataset.summary-272"><span class="linenos">272</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TramDagDataset.summary-273"><a href="#TramDagDataset.summary-273"><span class="linenos">273</span></a><span class="sd">        Print a structured overview of the dataset and configuration.</span>
</span><span id="TramDagDataset.summary-274"><a href="#TramDagDataset.summary-274"><span class="linenos">274</span></a>
</span><span id="TramDagDataset.summary-275"><a href="#TramDagDataset.summary-275"><span class="linenos">275</span></a><span class="sd">        The summary includes:</span>
</span><span id="TramDagDataset.summary-276"><a href="#TramDagDataset.summary-276"><span class="linenos">276</span></a>
</span><span id="TramDagDataset.summary-277"><a href="#TramDagDataset.summary-277"><span class="linenos">277</span></a><span class="sd">        1. DataFrame information:</span>
</span><span id="TramDagDataset.summary-278"><a href="#TramDagDataset.summary-278"><span class="linenos">278</span></a><span class="sd">        - Shape</span>
</span><span id="TramDagDataset.summary-279"><a href="#TramDagDataset.summary-279"><span class="linenos">279</span></a><span class="sd">        - Columns</span>
</span><span id="TramDagDataset.summary-280"><a href="#TramDagDataset.summary-280"><span class="linenos">280</span></a><span class="sd">        - Head (first rows)</span>
</span><span id="TramDagDataset.summary-281"><a href="#TramDagDataset.summary-281"><span class="linenos">281</span></a><span class="sd">        - Dtypes</span>
</span><span id="TramDagDataset.summary-282"><a href="#TramDagDataset.summary-282"><span class="linenos">282</span></a><span class="sd">        - Descriptive statistics</span>
</span><span id="TramDagDataset.summary-283"><a href="#TramDagDataset.summary-283"><span class="linenos">283</span></a>
</span><span id="TramDagDataset.summary-284"><a href="#TramDagDataset.summary-284"><span class="linenos">284</span></a><span class="sd">        2. Configuration overview:</span>
</span><span id="TramDagDataset.summary-285"><a href="#TramDagDataset.summary-285"><span class="linenos">285</span></a><span class="sd">        - Number of nodes</span>
</span><span id="TramDagDataset.summary-286"><a href="#TramDagDataset.summary-286"><span class="linenos">286</span></a><span class="sd">        - Loader mode (DataLoader vs. raw Dataset)</span>
</span><span id="TramDagDataset.summary-287"><a href="#TramDagDataset.summary-287"><span class="linenos">287</span></a><span class="sd">        - Precomputation status</span>
</span><span id="TramDagDataset.summary-288"><a href="#TramDagDataset.summary-288"><span class="linenos">288</span></a>
</span><span id="TramDagDataset.summary-289"><a href="#TramDagDataset.summary-289"><span class="linenos">289</span></a><span class="sd">        3. Node settings:</span>
</span><span id="TramDagDataset.summary-290"><a href="#TramDagDataset.summary-290"><span class="linenos">290</span></a><span class="sd">        - Batch size</span>
</span><span id="TramDagDataset.summary-291"><a href="#TramDagDataset.summary-291"><span class="linenos">291</span></a><span class="sd">        - Shuffle flag</span>
</span><span id="TramDagDataset.summary-292"><a href="#TramDagDataset.summary-292"><span class="linenos">292</span></a><span class="sd">        - num_workers</span>
</span><span id="TramDagDataset.summary-293"><a href="#TramDagDataset.summary-293"><span class="linenos">293</span></a><span class="sd">        - pin_memory</span>
</span><span id="TramDagDataset.summary-294"><a href="#TramDagDataset.summary-294"><span class="linenos">294</span></a><span class="sd">        - return_intercept_shift</span>
</span><span id="TramDagDataset.summary-295"><a href="#TramDagDataset.summary-295"><span class="linenos">295</span></a><span class="sd">        - debug</span>
</span><span id="TramDagDataset.summary-296"><a href="#TramDagDataset.summary-296"><span class="linenos">296</span></a><span class="sd">        - transform</span>
</span><span id="TramDagDataset.summary-297"><a href="#TramDagDataset.summary-297"><span class="linenos">297</span></a>
</span><span id="TramDagDataset.summary-298"><a href="#TramDagDataset.summary-298"><span class="linenos">298</span></a><span class="sd">        4. DataLoader overview:</span>
</span><span id="TramDagDataset.summary-299"><a href="#TramDagDataset.summary-299"><span class="linenos">299</span></a><span class="sd">        - Type and length of each loader.</span>
</span><span id="TramDagDataset.summary-300"><a href="#TramDagDataset.summary-300"><span class="linenos">300</span></a>
</span><span id="TramDagDataset.summary-301"><a href="#TramDagDataset.summary-301"><span class="linenos">301</span></a><span class="sd">        Parameters</span>
</span><span id="TramDagDataset.summary-302"><a href="#TramDagDataset.summary-302"><span class="linenos">302</span></a><span class="sd">        ----------</span>
</span><span id="TramDagDataset.summary-303"><a href="#TramDagDataset.summary-303"><span class="linenos">303</span></a><span class="sd">        None</span>
</span><span id="TramDagDataset.summary-304"><a href="#TramDagDataset.summary-304"><span class="linenos">304</span></a>
</span><span id="TramDagDataset.summary-305"><a href="#TramDagDataset.summary-305"><span class="linenos">305</span></a><span class="sd">        Returns</span>
</span><span id="TramDagDataset.summary-306"><a href="#TramDagDataset.summary-306"><span class="linenos">306</span></a><span class="sd">        -------</span>
</span><span id="TramDagDataset.summary-307"><a href="#TramDagDataset.summary-307"><span class="linenos">307</span></a><span class="sd">        None</span>
</span><span id="TramDagDataset.summary-308"><a href="#TramDagDataset.summary-308"><span class="linenos">308</span></a>
</span><span id="TramDagDataset.summary-309"><a href="#TramDagDataset.summary-309"><span class="linenos">309</span></a><span class="sd">        Notes</span>
</span><span id="TramDagDataset.summary-310"><a href="#TramDagDataset.summary-310"><span class="linenos">310</span></a><span class="sd">        -----</span>
</span><span id="TramDagDataset.summary-311"><a href="#TramDagDataset.summary-311"><span class="linenos">311</span></a><span class="sd">        Intended for quick inspection and debugging. Uses `print` statements</span>
</span><span id="TramDagDataset.summary-312"><a href="#TramDagDataset.summary-312"><span class="linenos">312</span></a><span class="sd">        and does not return structured metadata.</span>
</span><span id="TramDagDataset.summary-313"><a href="#TramDagDataset.summary-313"><span class="linenos">313</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TramDagDataset.summary-314"><a href="#TramDagDataset.summary-314"><span class="linenos">314</span></a>        
</span><span id="TramDagDataset.summary-315"><a href="#TramDagDataset.summary-315"><span class="linenos">315</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[TramDagDataset Summary]&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset.summary-316"><a href="#TramDagDataset.summary-316"><span class="linenos">316</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
</span><span id="TramDagDataset.summary-317"><a href="#TramDagDataset.summary-317"><span class="linenos">317</span></a>
</span><span id="TramDagDataset.summary-318"><a href="#TramDagDataset.summary-318"><span class="linenos">318</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[DataFrame]&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset.summary-319"><a href="#TramDagDataset.summary-319"><span class="linenos">319</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="TramDagDataset.summary-320"><a href="#TramDagDataset.summary-320"><span class="linenos">320</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Columns:&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
</span><span id="TramDagDataset.summary-321"><a href="#TramDagDataset.summary-321"><span class="linenos">321</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Head:&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset.summary-322"><a href="#TramDagDataset.summary-322"><span class="linenos">322</span></a>        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</span><span id="TramDagDataset.summary-323"><a href="#TramDagDataset.summary-323"><span class="linenos">323</span></a>
</span><span id="TramDagDataset.summary-324"><a href="#TramDagDataset.summary-324"><span class="linenos">324</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Dtypes:&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset.summary-325"><a href="#TramDagDataset.summary-325"><span class="linenos">325</span></a>        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</span><span id="TramDagDataset.summary-326"><a href="#TramDagDataset.summary-326"><span class="linenos">326</span></a>
</span><span id="TramDagDataset.summary-327"><a href="#TramDagDataset.summary-327"><span class="linenos">327</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Describe:&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset.summary-328"><a href="#TramDagDataset.summary-328"><span class="linenos">328</span></a>        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">))</span>
</span><span id="TramDagDataset.summary-329"><a href="#TramDagDataset.summary-329"><span class="linenos">329</span></a>
</span><span id="TramDagDataset.summary-330"><a href="#TramDagDataset.summary-330"><span class="linenos">330</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[Configuration]&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset.summary-331"><a href="#TramDagDataset.summary-331"><span class="linenos">331</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nodes: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset.summary-332"><a href="#TramDagDataset.summary-332"><span class="linenos">332</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loader mode: </span><span class="si">{</span><span class="s1">&#39;DataLoader&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">use_dataloader</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Direct dataset&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset.summary-333"><a href="#TramDagDataset.summary-333"><span class="linenos">333</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precomputed: </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;use_precomputed&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">False</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset.summary-334"><a href="#TramDagDataset.summary-334"><span class="linenos">334</span></a>
</span><span id="TramDagDataset.summary-335"><a href="#TramDagDataset.summary-335"><span class="linenos">335</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[Node Settings]&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset.summary-336"><a href="#TramDagDataset.summary-336"><span class="linenos">336</span></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="TramDagDataset.summary-337"><a href="#TramDagDataset.summary-337"><span class="linenos">337</span></a>            <span class="n">batch_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span>
</span><span id="TramDagDataset.summary-338"><a href="#TramDagDataset.summary-338"><span class="linenos">338</span></a>            <span class="n">shuffle_flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span>
</span><span id="TramDagDataset.summary-339"><a href="#TramDagDataset.summary-339"><span class="linenos">339</span></a>            <span class="n">num_workers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span>
</span><span id="TramDagDataset.summary-340"><a href="#TramDagDataset.summary-340"><span class="linenos">340</span></a>            <span class="n">pin_memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin_memory</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pin_memory</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin_memory</span>
</span><span id="TramDagDataset.summary-341"><a href="#TramDagDataset.summary-341"><span class="linenos">341</span></a>            <span class="n">rshift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_intercept_shift</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">return_intercept_shift</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_intercept_shift</span>
</span><span id="TramDagDataset.summary-342"><a href="#TramDagDataset.summary-342"><span class="linenos">342</span></a>            <span class="n">debug_flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span>
</span><span id="TramDagDataset.summary-343"><a href="#TramDagDataset.summary-343"><span class="linenos">343</span></a>            <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span>
</span><span id="TramDagDataset.summary-344"><a href="#TramDagDataset.summary-344"><span class="linenos">344</span></a>
</span><span id="TramDagDataset.summary-345"><a href="#TramDagDataset.summary-345"><span class="linenos">345</span></a>            <span class="nb">print</span><span class="p">(</span>
</span><span id="TramDagDataset.summary-346"><a href="#TramDagDataset.summary-346"><span class="linenos">346</span></a>                <span class="sa">f</span><span class="s2">&quot; Node &#39;</span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">&#39;: &quot;</span>
</span><span id="TramDagDataset.summary-347"><a href="#TramDagDataset.summary-347"><span class="linenos">347</span></a>                <span class="sa">f</span><span class="s2">&quot;batch_size=</span><span class="si">{</span><span class="n">batch_size</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="TramDagDataset.summary-348"><a href="#TramDagDataset.summary-348"><span class="linenos">348</span></a>                <span class="sa">f</span><span class="s2">&quot;shuffle=</span><span class="si">{</span><span class="n">shuffle_flag</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="TramDagDataset.summary-349"><a href="#TramDagDataset.summary-349"><span class="linenos">349</span></a>                <span class="sa">f</span><span class="s2">&quot;num_workers=</span><span class="si">{</span><span class="n">num_workers</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="TramDagDataset.summary-350"><a href="#TramDagDataset.summary-350"><span class="linenos">350</span></a>                <span class="sa">f</span><span class="s2">&quot;pin_memory=</span><span class="si">{</span><span class="n">pin_memory</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="TramDagDataset.summary-351"><a href="#TramDagDataset.summary-351"><span class="linenos">351</span></a>                <span class="sa">f</span><span class="s2">&quot;return_intercept_shift=</span><span class="si">{</span><span class="n">rshift</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="TramDagDataset.summary-352"><a href="#TramDagDataset.summary-352"><span class="linenos">352</span></a>                <span class="sa">f</span><span class="s2">&quot;debug=</span><span class="si">{</span><span class="n">debug_flag</span><span class="si">}</span><span class="s2">, &quot;</span>
</span><span id="TramDagDataset.summary-353"><a href="#TramDagDataset.summary-353"><span class="linenos">353</span></a>                <span class="sa">f</span><span class="s2">&quot;transform=</span><span class="si">{</span><span class="n">transform</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="TramDagDataset.summary-354"><a href="#TramDagDataset.summary-354"><span class="linenos">354</span></a>            <span class="p">)</span>
</span><span id="TramDagDataset.summary-355"><a href="#TramDagDataset.summary-355"><span class="linenos">355</span></a>
</span><span id="TramDagDataset.summary-356"><a href="#TramDagDataset.summary-356"><span class="linenos">356</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;loaders&quot;</span><span class="p">):</span>
</span><span id="TramDagDataset.summary-357"><a href="#TramDagDataset.summary-357"><span class="linenos">357</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[DataLoaders]&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset.summary-358"><a href="#TramDagDataset.summary-358"><span class="linenos">358</span></a>            <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">loader</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaders</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="TramDagDataset.summary-359"><a href="#TramDagDataset.summary-359"><span class="linenos">359</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="TramDagDataset.summary-360"><a href="#TramDagDataset.summary-360"><span class="linenos">360</span></a>                    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">loader</span><span class="p">)</span>
</span><span id="TramDagDataset.summary-361"><a href="#TramDagDataset.summary-361"><span class="linenos">361</span></a>                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="TramDagDataset.summary-362"><a href="#TramDagDataset.summary-362"><span class="linenos">362</span></a>                    <span class="n">length</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span>
</span><span id="TramDagDataset.summary-363"><a href="#TramDagDataset.summary-363"><span class="linenos">363</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">loader</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">, len=</span><span class="si">{</span><span class="n">length</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TramDagDataset.summary-364"><a href="#TramDagDataset.summary-364"><span class="linenos">364</span></a>
</span><span id="TramDagDataset.summary-365"><a href="#TramDagDataset.summary-365"><span class="linenos">365</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Print a structured overview of the dataset and configuration.</p>

<p>The summary includes:</p>

<ol>
<li>DataFrame information:</li>
</ol>

<ul>
<li>Shape</li>
<li>Columns</li>
<li>Head (first rows)</li>
<li>Dtypes</li>
<li>Descriptive statistics</li>
</ul>

<ol start="2">
<li>Configuration overview:</li>
</ol>

<ul>
<li>Number of nodes</li>
<li>Loader mode (DataLoader vs. raw Dataset)</li>
<li>Precomputation status</li>
</ul>

<ol start="3">
<li>Node settings:</li>
</ol>

<ul>
<li>Batch size</li>
<li>Shuffle flag</li>
<li>num_workers</li>
<li>pin_memory</li>
<li>return_intercept_shift</li>
<li>debug</li>
<li>transform</li>
</ul>

<ol start="4">
<li>DataLoader overview:</li>
</ol>

<ul>
<li>Type and length of each loader.</li>
</ul>

<h2 id="parameters">Parameters</h2>

<p>None</p>

<h2 id="returns">Returns</h2>

<p>None</p>

<h2 id="notes">Notes</h2>

<p>Intended for quick inspection and debugging. Uses <code>print</code> statements
and does not return structured metadata.</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>